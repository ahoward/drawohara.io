{
  "data": {
    "dojo4/dangling-rpc-fruit-off-of-your-rails-controllers": {
      "published_at": "2013-11-05 00:00:00 UTC",
      "title": "Dangling RPC Fruit Off Of Your Rails' Controllers",
      "author": "ara@dojo4.com",
      "body": "<div class=\"ro markdown\">\n  <p>when working on any non-hello-world rails application you invariably need teeny ajax helpers to communicate with the server - in order to perform client side logic.  i’m not talking an api per-se, but ad-hoc utilities like this:</p>\n\n<div class=\"language-javascript highlighter-rouge\"><code class='code' style='white-space:pre;'><div class='code-line code-line-1'>\n</div><div class='code-line code-line-2'><span style=\"color: #24292f;background-color: #f6f8fa\">markdown</span><span style=\"color: #24292f;background-color: #f6f8fa\">.</span><span style=\"color: #8250df\">change</span><span style=\"color: #24292f;background-color: #f6f8fa\">(</span><span style=\"color: #cf222e\">function</span><span style=\"color: #24292f;background-color: #f6f8fa\">(){</span>\n</div><div class='code-line code-line-3'>\n</div><div class='code-line code-line-4'>&nbsp;&nbsp;<span style=\"color: #8250df\">generate_html_on_the_server</span><span style=\"color: #24292f;background-color: #f6f8fa\">(</span>&nbsp;<span style=\"color: #24292f;background-color: #f6f8fa\">markdown</span><span style=\"color: #24292f;background-color: #f6f8fa\">.</span><span style=\"color: #8250df\">val</span><span style=\"color: #24292f;background-color: #f6f8fa\">(),</span>&nbsp;<span style=\"color: #cf222e\">function</span><span style=\"color: #24292f;background-color: #f6f8fa\">(</span><span style=\"color: #24292f;background-color: #f6f8fa\">html</span><span style=\"color: #24292f;background-color: #f6f8fa\">){</span>\n</div><div class='code-line code-line-5'>&nbsp;&nbsp;\n</div><div class='code-line code-line-6'>&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: #24292f;background-color: #f6f8fa\">preview</span><span style=\"color: #24292f;background-color: #f6f8fa\">.</span><span style=\"color: #8250df\">html</span><span style=\"color: #24292f;background-color: #f6f8fa\">(</span><span style=\"color: #24292f;background-color: #f6f8fa\">html</span><span style=\"color: #24292f;background-color: #f6f8fa\">);</span>\n</div><div class='code-line code-line-7'>&nbsp;&nbsp;\n</div><div class='code-line code-line-8'>&nbsp;&nbsp;<span style=\"color: #24292f;background-color: #f6f8fa\">});</span>\n</div><div class='code-line code-line-9'>\n</div><div class='code-line code-line-10'><span style=\"color: #24292f;background-color: #f6f8fa\">});</span>\n</div><div class='code-line code-line-11'>\n</div></code></div>\n\n<p>or</p>\n\n<div class=\"language-javascript highlighter-rouge\"><code class='code' style='white-space:pre;'><div class='code-line code-line-1'>\n</div><div class='code-line code-line-2'>\n</div><div class='code-line code-line-3'><span style=\"color: #24292f;background-color: #f6f8fa\">reservation</span><span style=\"color: #24292f;background-color: #f6f8fa\">.</span><span style=\"color: #8250df\">change</span><span style=\"color: #24292f;background-color: #f6f8fa\">(</span><span style=\"color: #cf222e\">function</span><span style=\"color: #24292f;background-color: #f6f8fa\">(){</span>\n</div><div class='code-line code-line-4'>\n</div><div class='code-line code-line-5'>\n</div><div class='code-line code-line-6'>&nbsp;&nbsp;<span style=\"color: #8250df\">check_availibity_on_the_server</span><span style=\"color: #24292f;background-color: #f6f8fa\">(</span>&nbsp;<span style=\"color: #24292f;background-color: #f6f8fa\">reservation</span><span style=\"color: #24292f;background-color: #f6f8fa\">.</span><span style=\"color: #8250df\">val</span><span style=\"color: #24292f;background-color: #f6f8fa\">(),</span>&nbsp;<span style=\"color: #cf222e\">function</span><span style=\"color: #24292f;background-color: #f6f8fa\">(</span><span style=\"color: #24292f;background-color: #f6f8fa\">data</span><span style=\"color: #24292f;background-color: #f6f8fa\">){</span>\n</div><div class='code-line code-line-7'>&nbsp;&nbsp;\n</div><div class='code-line code-line-8'>&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: #cf222e\">if</span><span style=\"color: #24292f;background-color: #f6f8fa\">(</span><span style=\"color: #0550ae\">!</span><span style=\"color: #24292f;background-color: #f6f8fa\">data</span><span style=\"color: #24292f;background-color: #f6f8fa\">[</span><span style=\"color: #0a3069\">'</span><span style=\"color: #0a3069\">available</span><span style=\"color: #0a3069\">'</span><span style=\"color: #24292f;background-color: #f6f8fa\">]){</span>\n</div><div class='code-line code-line-9'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\n</div><div class='code-line code-line-10'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: #8250df\">alert</span><span style=\"color: #24292f;background-color: #f6f8fa\">(</span><span style=\"color: #0a3069\">'</span><span style=\"color: #0a3069\">that time is not available - pick another!</span><span style=\"color: #0a3069\">'</span><span style=\"color: #24292f;background-color: #f6f8fa\">);</span>\n</div><div class='code-line code-line-11'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\n</div><div class='code-line code-line-12'>&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: #24292f;background-color: #f6f8fa\">};</span>\n</div><div class='code-line code-line-13'>&nbsp;&nbsp;<span style=\"color: #24292f;background-color: #f6f8fa\">})</span>\n</div><div class='code-line code-line-14'>\n</div><div class='code-line code-line-15'><span style=\"color: #24292f;background-color: #f6f8fa\">});</span>\n</div><div class='code-line code-line-16'>\n</div><div class='code-line code-line-17'>\n</div></code></div>\n\n<p>etc.</p>\n\n<p>these types of functions aren’t part of a server-to-server public api, they are just cooperating js/backend endpoints that are needed to make the view function.</p>\n\n<p>most rails’ applications will accumulate many of these and the question arises:</p>\n\n<p>“Where do you put them?”</p>\n\n<p>in most teams you’ll have three or four developers naming and organizing these functions differently, ensuring that the code base turns into a cowboy spaghetti mess in short order.</p>\n\n<p>@dojo4 we’ve abstracted this with a teeny rpc design pattern:  first we have a teeny controller dsl that’s included into our ApplicationController that allows declarative definitions of ‘rpc’ js helpers on a per-controller basis.</p>\n\n<div class=\"language-ruby highlighter-rouge\"><code class='code' style='white-space:pre;'><div class='code-line code-line-1'>\n</div><div class='code-line code-line-2'><span style=\"color: #cf222e\">class</span>&nbsp;<span style=\"color: #953800\">ApplicationController</span>&nbsp;<span style=\"color: #0550ae\">&lt;</span>&nbsp;<span style=\"color: #953800\">ActionController</span><span style=\"color: #0550ae\">::</span><span style=\"color: #953800\">Base</span>\n</div><div class='code-line code-line-3'>\n</div><div class='code-line code-line-4'>&nbsp;&nbsp;<span style=\"color: #cf222e\">include</span><span style=\"color: #24292f;background-color: #f6f8fa\">(</span><span style=\"color: #953800\">RPC</span><span style=\"color: #24292f;background-color: #f6f8fa\">)</span>\n</div><div class='code-line code-line-5'>\n</div><div class='code-line code-line-6'><span style=\"color: #cf222e\">end</span>\n</div><div class='code-line code-line-7'>\n</div><div class='code-line code-line-8'>\n</div></code></div>\n\n<p>check out the implementation here: <a href=\"https://gist.github.com/ahoward/7320900\" target=\"_blank\">https://gist.github.com/ahoward/7320900</a></p>\n\n<p>in plain english this dsl just defined a single action on the controller that multi-plexes which method to employ based on params, and an easy way to define them.  it expects that all rpc actions will return a hash and give back json.</p>\n\n<p>it’s implementation boils down to</p>\n\n<div class=\"language-ruby highlighter-rouge\"><code class='code' style='white-space:pre;'><div class='code-line code-line-1'>\n</div><div class='code-line code-line-2'>&nbsp;&nbsp;<span style=\"color: #cf222e\">def</span>&nbsp;<span style=\"color: #8250df\">rpc</span>\n</div><div class='code-line code-line-3'>&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: #24292f;background-color: #f6f8fa\">which</span>&nbsp;<span style=\"color: #0550ae\">=</span>&nbsp;<span style=\"color: #24292f;background-color: #f6f8fa\">params</span><span style=\"color: #24292f;background-color: #f6f8fa\">[</span><span style=\"color: #0a3069\">'method'</span><span style=\"color: #24292f;background-color: #f6f8fa\">]</span>\n</div><div class='code-line code-line-4'>&nbsp;&nbsp;&nbsp;&nbsp;\n</div><div class='code-line code-line-5'>&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: #24292f;background-color: #f6f8fa\">action</span>&nbsp;<span style=\"color: #0550ae\">=</span>&nbsp;<span style=\"color: #0550ae\">@rpc</span><span style=\"color: #24292f;background-color: #f6f8fa\">[</span><span style=\"color: #24292f;background-color: #f6f8fa\">which</span><span style=\"color: #24292f;background-color: #f6f8fa\">]</span>\n</div><div class='code-line code-line-6'>&nbsp;&nbsp;&nbsp;&nbsp;\n</div><div class='code-line code-line-7'>&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: #24292f;background-color: #f6f8fa\">result</span>&nbsp;<span style=\"color: #0550ae\">=</span>&nbsp;<span style=\"color: #24292f;background-color: #f6f8fa\">action</span><span style=\"color: #24292f;background-color: #f6f8fa\">.</span><span style=\"color: #8250df\">call</span><span style=\"color: #24292f;background-color: #f6f8fa\">(</span><span style=\"color: #24292f;background-color: #f6f8fa\">params</span><span style=\"color: #24292f;background-color: #f6f8fa\">)</span>\n</div><div class='code-line code-line-8'>&nbsp;&nbsp;&nbsp;&nbsp;\n</div><div class='code-line code-line-9'>&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: #24292f;background-color: #f6f8fa\">render</span>&nbsp;<span style=\"color: #0a3069\">:json</span>&nbsp;<span style=\"color: #0550ae\">=&gt;</span>&nbsp;<span style=\"color: #24292f;background-color: #f6f8fa\">result</span><span style=\"color: #24292f;background-color: #f6f8fa\">.</span><span style=\"color: #8250df\">to_json</span>\n</div><div class='code-line code-line-10'>&nbsp;&nbsp;<span style=\"color: #cf222e\">end</span>\n</div><div class='code-line code-line-11'>\n</div><div class='code-line code-line-12'>\n</div></code></div>\n\n<p>it’s usage should be obvious from the code</p>\n\n<div class=\"language-ruby highlighter-rouge\"><code class='code' style='white-space:pre;'><div class='code-line code-line-1'>\n</div><div class='code-line code-line-2'><span style=\"color: #cf222e\">class</span>&nbsp;<span style=\"color: #953800\">GeoLocationController</span>&nbsp;<span style=\"color: #0550ae\">&lt;</span>&nbsp;<span style=\"color: #953800\">ApplicationController</span>\n</div><div class='code-line code-line-3'>\n</div><div class='code-line code-line-4'>&nbsp;&nbsp;<span style=\"color: #24292f;background-color: #f6f8fa\">rpc</span><span style=\"color: #24292f;background-color: #f6f8fa\">(</span><span style=\"color: #0a3069\">:geo_location</span><span style=\"color: #24292f;background-color: #f6f8fa\">)</span>&nbsp;<span style=\"color: #cf222e\">do</span>&nbsp;<span style=\"color: #0550ae\">|</span><span style=\"color: #24292f;background-color: #f6f8fa\">params</span><span style=\"color: #0550ae\">|</span>\n</div><div class='code-line code-line-5'>&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: #24292f;background-color: #f6f8fa\">geo_location</span>&nbsp;<span style=\"color: #0550ae\">=</span>&nbsp;<span style=\"color: #953800\">GeoLocation</span><span style=\"color: #24292f;background-color: #f6f8fa\">.</span><span style=\"color: #8250df\">geo_locate</span><span style=\"color: #24292f;background-color: #f6f8fa\">(</span>&nbsp;<span style=\"color: #24292f;background-color: #f6f8fa\">params</span><span style=\"color: #24292f;background-color: #f6f8fa\">[</span><span style=\"color: #0a3069\">'address'</span><span style=\"color: #24292f;background-color: #f6f8fa\">]</span>&nbsp;<span style=\"color: #24292f;background-color: #f6f8fa\">)</span>\n</div><div class='code-line code-line-6'>&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: #24292f;background-color: #f6f8fa\">geo_location</span><span style=\"color: #24292f;background-color: #f6f8fa\">.</span><span style=\"color: #8250df\">attributes</span>\n</div><div class='code-line code-line-7'>&nbsp;&nbsp;<span style=\"color: #cf222e\">end</span>\n</div><div class='code-line code-line-8'>&nbsp;&nbsp;\n</div><div class='code-line code-line-9'>&nbsp;&nbsp;<span style=\"color: #24292f;background-color: #f6f8fa\">rpc</span><span style=\"color: #24292f;background-color: #f6f8fa\">(</span><span style=\"color: #0a3069\">:lat_lng</span><span style=\"color: #24292f;background-color: #f6f8fa\">)</span>&nbsp;<span style=\"color: #cf222e\">do</span>&nbsp;<span style=\"color: #0550ae\">|</span><span style=\"color: #24292f;background-color: #f6f8fa\">params</span><span style=\"color: #0550ae\">|</span>\n</div><div class='code-line code-line-10'>&nbsp;&nbsp;&nbsp;<span style=\"color: #24292f;background-color: #f6f8fa\">geo_location</span>&nbsp;<span style=\"color: #0550ae\">=</span>&nbsp;<span style=\"color: #953800\">GeoLocation</span><span style=\"color: #24292f;background-color: #f6f8fa\">.</span><span style=\"color: #8250df\">geo_locate</span><span style=\"color: #24292f;background-color: #f6f8fa\">(</span>&nbsp;<span style=\"color: #24292f;background-color: #f6f8fa\">params</span><span style=\"color: #24292f;background-color: #f6f8fa\">[</span><span style=\"color: #0a3069\">'address'</span><span style=\"color: #24292f;background-color: #f6f8fa\">]</span>&nbsp;<span style=\"color: #24292f;background-color: #f6f8fa\">)</span>\n</div><div class='code-line code-line-11'>&nbsp;&nbsp;&nbsp;<span style=\"color: #24292f;background-color: #f6f8fa\">{</span>&nbsp;<span style=\"color: #0a3069\">'lat'</span>&nbsp;<span style=\"color: #0550ae\">=&gt;</span>&nbsp;<span style=\"color: #24292f;background-color: #f6f8fa\">geo_location</span><span style=\"color: #24292f;background-color: #f6f8fa\">.</span><span style=\"color: #8250df\">lat</span><span style=\"color: #24292f;background-color: #f6f8fa\">,</span>&nbsp;<span style=\"color: #0a3069\">'lng'</span>&nbsp;<span style=\"color: #0550ae\">=&gt;</span>&nbsp;<span style=\"color: #24292f;background-color: #f6f8fa\">geo_location</span><span style=\"color: #24292f;background-color: #f6f8fa\">.</span><span style=\"color: #8250df\">lng</span>&nbsp;<span style=\"color: #24292f;background-color: #f6f8fa\">}</span>\n</div><div class='code-line code-line-12'>&nbsp;&nbsp;<span style=\"color: #cf222e\">end</span>\n</div><div class='code-line code-line-13'><span style=\"color: #cf222e\">end</span>\n</div><div class='code-line code-line-14'>\n</div><div class='code-line code-line-15'>\n</div></code></div>\n\n<p>usage from js requires two things: a route, and a teeny js class.  first the route:</p>\n\n<div class=\"language-ruby highlighter-rouge\"><code class='code' style='white-space:pre;'><div class='code-line code-line-1'>\n</div><div class='code-line code-line-2'>&nbsp;&nbsp;<span style=\"color: #24292f;background-color: #f6f8fa\">match</span>&nbsp;<span style=\"color: #0a3069\">':controller#rpc'</span><span style=\"color: #24292f;background-color: #f6f8fa\">,</span>&nbsp;<span style=\"color: #0a3069\">:action</span>&nbsp;<span style=\"color: #0550ae\">=&gt;</span>&nbsp;<span style=\"color: #0a3069\">'rpc'</span>\n</div><div class='code-line code-line-3'>&nbsp;&nbsp;\n</div><div class='code-line code-line-4'>\n</div></code></div>\n\n<p>next, the js, also here -&gt; <a href=\"https://gist.github.com/ahoward/7320900\" target=\"_blank\">https://gist.github.com/ahoward/7320900</a></p>\n\n<p>reading over that you can see that using the backend rpc actions from js is as simpile as</p>\n\n<pre><code>\n  var rpc = new RPC(url);\n\n  rpc.call('geo_location', params, callback);\n\n\n</code></pre>\n\n<p>normally, at the bottom of a view, we’re just intantiating an rpc object for the page with a relative url</p>\n\n<div class=\"language-erb highlighter-rouge\"><code class='code' style='white-space:pre;'><div class='code-line code-line-1'><span style=\"color: #116329\">&lt;script&gt;</span>\n</div><div class='code-line code-line-2'>&nbsp;&nbsp;<span style=\"color: #8250df\">jQuery</span><span style=\"color: #24292f;background-color: #f6f8fa\">(</span><span style=\"color: #cf222e\">function</span><span style=\"color: #24292f;background-color: #f6f8fa\">(){</span>\n</div><div class='code-line code-line-3'>&nbsp;\n</div><div class='code-line code-line-4'>\n</div><div class='code-line code-line-5'>&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: #cf222e\">var</span>&nbsp;<span style=\"color: #24292f;background-color: #f6f8fa\">rpc</span>&nbsp;<span style=\"color: #0550ae\">=</span>&nbsp;<span style=\"color: #cf222e\">new</span>&nbsp;<span style=\"color: #24292f;background-color: #f6f8fa\">RPC</span><span style=\"color: #24292f;background-color: #f6f8fa\">(</span><span style=\"color: #6e7781\">&lt;%=</span>&nbsp;<span style=\"color: #24292f;background-color: #f6f8fa\">raw</span>&nbsp;<span style=\"color: #24292f;background-color: #f6f8fa\">url_for</span><span style=\"color: #24292f;background-color: #f6f8fa\">(</span><span style=\"color: #0a3069\">:action</span>&nbsp;<span style=\"color: #0550ae\">=&gt;</span>&nbsp;<span style=\"color: #0a3069\">:rpc</span><span style=\"color: #24292f;background-color: #f6f8fa\">).</span><span style=\"color: #8250df\">to_json</span>&nbsp;<span style=\"color: #6e7781\">%&gt;</span><span style=\"color: #24292f;background-color: #f6f8fa\">);</span>\n</div><div class='code-line code-line-6'>&nbsp;&nbsp;&nbsp;&nbsp;\n</div><div class='code-line code-line-7'>&nbsp;&nbsp;\n</div><div class='code-line code-line-8'>&nbsp;&nbsp;<span style=\"color: #24292f;background-color: #f6f8fa\">});</span>\n</div><div class='code-line code-line-9'>&nbsp;&nbsp;\n</div><div class='code-line code-line-10'><span style=\"color: #116329\">&lt;/script&gt;</span>\n</div><div class='code-line code-line-11'>\n</div></code></div>\n\n<p>and we’re off and running.</p>\n\n<p>so, there you have it - a simple way to keep your rpc helper js from polluting your controllers and views with varied strategies and another example about how having <em>brutally consistent</em> interfaces makes abstraction possible and simple.</p>\n\n<p>update: the entire approach can be summarized like this</p>\n\n<div class=\"language-ruby highlighter-rouge\"><code class='code' style='white-space:pre;'><div class='code-line code-line-1'>\n</div><div class='code-line code-line-2'><span style=\"color: #cf222e\">class</span>&nbsp;<span style=\"color: #953800\">BaseController</span>\n</div><div class='code-line code-line-3'>&nbsp;&nbsp;<span style=\"color: #953800\">RPC</span>&nbsp;<span style=\"color: #0550ae\">=</span>&nbsp;<span style=\"color: #953800\">Hash</span><span style=\"color: #24292f;background-color: #f6f8fa\">.</span><span style=\"color: #8250df\">new</span>\n</div><div class='code-line code-line-4'>\n</div><div class='code-line code-line-5'>&nbsp;&nbsp;<span style=\"color: #cf222e\">def</span>&nbsp;<span style=\"color: #953800\">self</span><span style=\"color: #0550ae\">.</span><span style=\"color: #8250df\">rpc</span><span style=\"color: #24292f;background-color: #f6f8fa\">(</span><span style=\"color: #24292f;background-color: #f6f8fa\">method_name</span><span style=\"color: #24292f;background-color: #f6f8fa\">,</span>&nbsp;<span style=\"color: #0550ae\">&amp;</span><span style=\"color: #24292f;background-color: #f6f8fa\">block</span><span style=\"color: #24292f;background-color: #f6f8fa\">)</span>\n</div><div class='code-line code-line-6'>&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: #953800\">RPC</span><span style=\"color: #24292f;background-color: #f6f8fa\">[</span><span style=\"color: #24292f;background-color: #f6f8fa\">method_name</span><span style=\"color: #24292f;background-color: #f6f8fa\">]</span>&nbsp;<span style=\"color: #0550ae\">=</span>&nbsp;<span style=\"color: #24292f;background-color: #f6f8fa\">block</span>\n</div><div class='code-line code-line-7'>&nbsp;&nbsp;<span style=\"color: #cf222e\">end</span>\n</div><div class='code-line code-line-8'>\n</div><div class='code-line code-line-9'>&nbsp;&nbsp;<span style=\"color: #cf222e\">def</span>&nbsp;<span style=\"color: #8250df\">rpc</span>\n</div><div class='code-line code-line-10'>&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: #24292f;background-color: #f6f8fa\">method_name</span>&nbsp;<span style=\"color: #0550ae\">=</span>&nbsp;<span style=\"color: #24292f;background-color: #f6f8fa\">params</span><span style=\"color: #24292f;background-color: #f6f8fa\">[</span><span style=\"color: #0a3069\">'method_name'</span><span style=\"color: #24292f;background-color: #f6f8fa\">]</span>\n</div><div class='code-line code-line-11'>\n</div><div class='code-line code-line-12'>&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: #24292f;background-color: #f6f8fa\">block</span>&nbsp;<span style=\"color: #0550ae\">=</span>&nbsp;<span style=\"color: #953800\">RPC</span><span style=\"color: #24292f;background-color: #f6f8fa\">[</span><span style=\"color: #24292f;background-color: #f6f8fa\">method_name</span><span style=\"color: #24292f;background-color: #f6f8fa\">]</span>\n</div><div class='code-line code-line-13'>\n</div><div class='code-line code-line-14'>&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: #24292f;background-color: #f6f8fa\">result</span>&nbsp;<span style=\"color: #0550ae\">=</span>&nbsp;<span style=\"color: #24292f;background-color: #f6f8fa\">block</span><span style=\"color: #24292f;background-color: #f6f8fa\">.</span><span style=\"color: #8250df\">call</span><span style=\"color: #24292f;background-color: #f6f8fa\">(</span><span style=\"color: #24292f;background-color: #f6f8fa\">params</span><span style=\"color: #24292f;background-color: #f6f8fa\">)</span>\n</div><div class='code-line code-line-15'>\n</div><div class='code-line code-line-16'>&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: #24292f;background-color: #f6f8fa\">render</span>&nbsp;<span style=\"color: #0a3069\">:json</span>&nbsp;<span style=\"color: #0550ae\">=&gt;</span>&nbsp;<span style=\"color: #24292f;background-color: #f6f8fa\">result</span>\n</div><div class='code-line code-line-17'>&nbsp;&nbsp;<span style=\"color: #cf222e\">end</span>\n</div><div class='code-line code-line-18'><span style=\"color: #cf222e\">end</span>\n</div><div class='code-line code-line-19'>\n</div><div class='code-line code-line-20'>\n</div><div class='code-line code-line-21'><span style=\"color: #cf222e\">class</span>&nbsp;<span style=\"color: #953800\">Controller</span>\n</div><div class='code-line code-line-22'>&nbsp;&nbsp;<span style=\"color: #24292f;background-color: #f6f8fa\">rpc</span>&nbsp;<span style=\"color: #0a3069\">:teh_method</span>&nbsp;<span style=\"color: #cf222e\">do</span>\n</div><div class='code-line code-line-23'>&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: #24292f;background-color: #f6f8fa\">{</span><span style=\"color: #0a3069\">'K'</span>&nbsp;<span style=\"color: #0550ae\">=&gt;</span>&nbsp;<span style=\"color: #24292f;background-color: #f6f8fa\">params</span><span style=\"color: #24292f;background-color: #f6f8fa\">[</span><span style=\"color: #0a3069\">'k'</span><span style=\"color: #24292f;background-color: #f6f8fa\">].</span><span style=\"color: #8250df\">upcase</span><span style=\"color: #24292f;background-color: #f6f8fa\">}</span>\n</div><div class='code-line code-line-24'>&nbsp;&nbsp;<span style=\"color: #cf222e\">end</span>\n</div><div class='code-line code-line-25'><span style=\"color: #cf222e\">end</span>\n</div><div class='code-line code-line-26'>\n</div><div class='code-line code-line-27'>\n</div><div class='code-line code-line-28'><span style=\"color: #6e7781\"># curl http://0.0.0.0:3000/foo/rpc?method_name=teh_method&amp;k=v  #=&gt; {'K' : 'V'}</span>\n</div><div class='code-line code-line-29'>\n</div></code></div>\n\n\n</div>\n",
      "assets": {},
      "_meta": {
        "identifier": "dojo4/dangling-rpc-fruit-off-of-your-rails-controllers",
        "type": "dojo4",
        "id": "dangling-rpc-fruit-off-of-your-rails-controllers",
        "urls": [
          "/ro/dojo4/dangling-rpc-fruit-off-of-your-rails-controllers/body.md"
        ],
        "created_at": "2025-05-06 08:47:13 +0000",
        "updated_at": "2025-05-06 08:47:13 +0000",
        "rel": {
          "curr": "dojo4/dangling-rpc-fruit-off-of-your-rails-controllers",
          "prev": "dojo4/screen-set-up-your-project-s-terminal-environment-once-and-only-once",
          "next": "dojo4/the-5-mystical-practices-of-great-engineers"
        }
      }
    }
  },
  "_meta": {
    "url": "/ro",
    "type": "dojo4",
    "id": "dangling-rpc-fruit-off-of-your-rails-controllers"
  }
}