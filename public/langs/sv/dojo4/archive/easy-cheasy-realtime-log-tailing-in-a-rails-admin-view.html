<html color-mode="user" lang="sv">
  <head>
    <base href='/sv' />
    <!-- ga -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-DQVD9T27V4"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-DQVD9T27V4');
    </script>

    <!-- deps -->
    <script type="module" src="/assets/js/turbo.es2017-esm.js" defer></script>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.fluid.classless.fuchsia.min.css"
    >

    <!-- defaults -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="color-scheme" content="light dark" />

    <!-- favicon -->
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">

    <!-- meta -->
    <title>enkelt realtidsloggning i en rails adminvy</title>

    <meta property="og:title" content="enkelt realtidsloggning i en rails adminvy"/>
    <meta property="og:description" content="gå vidare." />
    <meta property="og:image" content="https://drawohara.io/media/mick.jpg" />

    <meta property="og:image:type" content="image/jpeg" />

    <meta property="site:route" content=""/dojo4/archive/:id"">
    <meta property="site:params" content="{"ext":null,"id":"enkelt-realtidsloggning-i-en-rails-adminvy"}">
    <meta property="site:path_info" content=""/enkelt-realtidsloggning-i-en-rails-adminvy"">

    <style>
      /* anti pico */
      a {text-decoration: none !important; }

      /* anti turbo */
      html { transition: none !important; }
      .turbo-progress-bar { visibility: hidden; }

      /* anti progressive */
      html { margin: 1em; }
      img { display: block; text-align: center; }
    </style>

    <script>
      document.addEventListener("turbo:load", function() {
        const progressBar = document.querySelector('.turbo-progress-bar');
        if (progressBar) {
          progressBar.remove();
        }
      });
    </script>
  </head>

  <body>
    <header>
      <a href="/home">@drawohara</a>
      <hr>
    </header>

    <main>
      <div class="ro markdown">
        <p>i våra rails-appar har vi alltid en ‘/su’ eller ‘superanvändar’-sektion. vi dumpar saker som rapporter i den bakänden. nyligen behövde jag tillåta superanvändare att se loggar i realtid från webbläsaren (för att hjälpa till med felsökning av brandväggsproblem för en licensserver som vi byggde). jag övervägde att göra något smart som websockets och sedan blev jag klok och bestämde mig för att göra det enklaste som kunde fungera - kom ihåg, det här är endast för superanvändare så följande pollingansats är <em>jooohh dandy</em>…<br />
        <br /><br />
        <br /></p>

        <p>steg ett var att ställa in en åtgärd och en vy som kunde ta en logg, visa den och sedan ajax-polla för att uppdatera den. glasyr var att lägga till en fin UI (aka <em>länk</em>) som kunde starta och stoppa pollingen<br />
        <br /><br />
        <br /></p>

        <p>här är en majoritet av den relevanta koden<br />
        <br /><br />
        <br /></p>

        <script src="https://gist.github.com/1994292.js?file=tail-f.rb"></script>

        <p><br /><br />
        <br /></p>

        <p>steg två, som visas i den gisten, var att tysta ner den rekursiva loggerfunktionen som jag av misstag lade till: aka - pollingajaxen själv skapade massor av loggerutdata.<br />
        <br /></p>

        <p>så där har du det. lågt tekniskt. enkelt. k.i.s.s. loggning för administratörer.<br />
        <br /><br />
        <br /></p>

      </div>
    </main>

    <footer>
      <hr>
      <a href="/goto" name="goto">&mdash;&gt; gå till</a>
      <blockquote>
        <ul>
          <li>
            <a href="/about">om<a>
          </li>
          <li>
            <a href="mailto:i-hate-this@drawohara.io?subject=/enkelt-realtidsloggning-i-en-rails-adminvy">i-hate-this<a>
          </li>
          <li>
            <a href="mailto:i-love-this@drawohara.io?subject=/enkelt-realtidsloggning-i-en-rails-adminvy">i-love-this<a>
          </li>
          <li>
            <a href="/contact">kontakt<a>
          </li>
        </ul>
      </blockquote>
      <a href="/">&lt;&mdash; avsluta</a>
    </footer>
  </body>
</html>