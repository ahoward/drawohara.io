<html color-mode="user" lang="es">
  <head>
    <base href='/es' />
    <!-- ga -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-DQVD9T27V4"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-DQVD9T27V4');
    </script>

    <!-- deps -->
    <script type="module" src="/assets/js/turbo.es2017-esm.js" defer></script>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.fluid.classless.fuchsia.min.css"
    >

    <!-- defaults -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="color-scheme" content="light dark" />

    <!-- favicon -->
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">

    <!-- meta -->
    <title>Procesando archivos ENORMES con una entrada de archivo html5</title>

    <meta property="og:title" content="Procesando archivos ENORMES con una entrada de archivo html5"/>
    <meta property="og:description" content="sigue adelante." />
    <meta property="og:image" content="https://drawohara.io/media/mick.jpg" />

    <meta property="og:image:type" content="image/jpeg" />

    <meta property="site:route" content="/dojo4/archivo/:id">
    <meta property="site:params" content="{'ext':null,'id':'procesando-archivos-enormes-con-una-entrada-de-archivo-html5'}">
    <meta property="site:path_info" content="/procesando-archivos-enormes-con-una-entrada-de-archivo-html5">

    <style>
      /* anti pico */
      a {text-decoration: none !important; }

      /* anti turbo */
      html { transition: none !important; }
      .turbo-progress-bar { visibility: hidden; }

      /* anti progressive */
      html { margin: 1em; }
      img { display: block; text-align: center; }
    </style>

    <script>
      document.addEventListener("turbo:load", function() {
        const progressBar = document.querySelector('.turbo-progress-bar');
        if (progressBar) {
          progressBar.remove();
        }
      });
    </script>
  </head>

  <body>
    <header>
      <a href="/inicio">@drawohara</a>
      <hr>
    </header>

    <main>
      <div class="ro markdown">
        <p>Estaba jugando con un código que requería procesar un archivo enorme (> 600 mb) con un tipo de entrada de archivo html5. Me tomó algo de tiempo antes de descubrir cómo procesar un archivo enorme sin que el navegador se bloqueara. Aquí está la esencia:</p>

        <div class="language-html highlighter-rouge"><code class='code' style='white-space:pre;'><div class='code-line code-line-1'>
        </div><div class='code-line code-line-2'>&nbsp;&nbsp;<span style="color: #6e7781">&lt;!--</span>
        </div><div class='code-line code-line-3'>
        </div><div class='code-line code-line-4'><span style="color: #6e7781">  realizar una carga fragmentada grande de contenido utilizando la función de entrada de archivo html5 es complicado.</span>
        </div><div class='code-line code-line-5'><span style="color: #6e7781">  </span>
        </div><div class='code-line code-line-6'><span style="color: #6e7781">  este sencillo ejemplo debería ayudarte.</span>
        </div><div class='code-line code-line-7'>
        </div><div class='code-line code-line-8'><span style="color: #6e7781">--&gt;</span>
        </div><div class='code-line code-line-9'>
        </div><div class='code-line code-line-10'><span style="color: #116329">&lt;br&gt;</span>
        </div><div class='code-line code-line-11'><span style="color: #116329">&lt;br&gt;</span>
        </div><div class='code-line code-line-12'><span style="color: #116329">&lt;br&gt;</span>
        </div><div class='code-line code-line-13'><span style="color: #116329">&lt;hr&gt;</span>
        </div><div class='code-line code-line-14'>
        </div><div class='code-line code-line-15'><span style="color: #116329">&lt;center&gt;</span>
        </div><div class='code-line code-line-16'>&nbsp;&nbsp;<span style="color: #116329">&lt;blink&gt;</span>
        </div><div class='code-line code-line-17'>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #116329">&lt;input</span>&nbsp;<span style="color: #116329">type=</span><span style="color: #0a3069">'file'</span>&nbsp;<span style="color: #116329">name=</span><span style="color: #0a3069">'file'</span>&nbsp;<span style="color: #116329">id=</span><span style="color: #0a3069">'file'</span>&nbsp;<span style="color: #116329">/&gt;</span>
        </div><div class='code-line code-line-18'>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #116329">&lt;br&gt;</span>
        </div><div class='code-line code-line-19'>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #116329">&lt;div</span>&nbsp;<span style="color: #116329">id=</span><span style="color: #0a3069">'progress'</span>&nbsp;<span style="color: #116329">/&gt;</span>
        </div><div class='code-line code-line-20'>&nbsp;&nbsp;<span style="color: #116329">&lt;/blink&gt;</span>
        </div><div class='code-line code-line-21'><span style="color: #116329">&lt;/center&gt;</span>
        </div><div class='code-line code-line-22'>
        </div><div class='code-line code-line-23'><span style="color: #116329">&lt;script&gt;</span>
        </div><div class='code-line code-line-24'>&nbsp;&nbsp;<span style="color: #8250df">jQuery</span><span style="color: #24292f;background-color: #f6f8fa">(</span><span style="color: #0a3069">'</span><span style="color: #0a3069">#file</span><span style="color: #0a3069">'</span><span style="color: #24292f;background-color: #f6f8fa">).</span><span style="color: #8250df">change</span><span style="color: #24292f;background-color: #f6f8fa">(</span><span style="color: #cf222e">function</span><span style="color: #24292f;background-color: #f6f8fa">(){</span>
        </div><div class='code-line code-line-25'>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #cf222e">var</span>&nbsp;<span style="color: #24292f;background-color: #f6f8fa">file</span>&nbsp;<span style="color: #0550ae">=</span>&nbsp;<span style="color: #953800">document</span><span style="color: #24292f;background-color: #f6f8fa">.</span><span style="color: #8250df">getElementById</span><span style="color: #24292f;background-color: #f6f8fa">(</span><span style="color: #0a3069">'</span><span style="color: #0a3069">file</span><span style="color: #0a3069">'</span><span style="color: #24292f;background-color: #f6f8fa">).</span><span style="color: #24292f;background-color: #f6f8fa">files</span><span style="color: #24292f;background-color: #f6f8fa">[</span><span style="color: #0550ae">0</span><span style="color: #24292f;background-color: #f6f8fa">];</span>
        </div><div class='code-line code-line-26'>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #cf222e">var</span>&nbsp;<span style="color: #24292f;background-color: #f6f8fa">progress</span>&nbsp;<span style="color: #0550ae">=</span>&nbsp;<span style="color: #8250df">jQuery</span><span style="color: #24292f;background-color: #f6f8fa">(</span><span style="color: #0a3069">'</span><span style="color: #0a3069">#progress</span><span style="color: #0a3069">'</span><span style="color: #24292f;background-color: #f6f8fa">);</span>
        </div><div class='code-line code-line-27'>
        </div><div class='code-line code-line-28'>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #cf222e">if</span><span style="color: #24292f;background-color: #f6f8fa">(</span><span style="color: #24292f;background-color: #f6f8fa">file</span><span style="color: #24292f;background-color: #f6f8fa">){</span>
        </div><div class='code-line code-line-29'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #cf222e">var</span>&nbsp;<span style="color: #24292f;background-color: #f6f8fa">reader</span>&nbsp;<span style="color: #0550ae">=</span>&nbsp;<span style="color: #cf222e">new</span>&nbsp;<span style="color: #953800">FileReader</span><span style="color: #24292f;background-color: #f6f8fa">();</span>
        </div><div class='code-line code-line-30'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #cf222e">var</span>&nbsp;<span style="color: #24292f;background-color: #f6f8fa">size</span>&nbsp;<span style="color: #0550ae">=</span>&nbsp;<span style="color: #24292f;background-color: #f6f8fa">file</span><span style="color: #24292f;background-color: #f6f8fa">.</span><span style="color: #24292f;background-color: #f6f8fa">size</span><span style="color: #24292f;background-color: #f6f8fa">;</span>
        </div><div class='code-line code-line-31'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #cf222e">var</span>&nbsp;<span style="color: #24292f;background-color: #f6f8fa">chunk_size</span>&nbsp;<span style="color: #0550ae">=</span>&nbsp;<span style="color: #953800">Math</span><span style="color: #24292f;background-color: #f6f8fa">.</span><span style="color: #8250df">pow</span><span style="color: #24292f;background-color: #f6f8fa">(</span><span style="color: #0550ae">2</span><span style="color: #24292f;background-color: #f6f8fa">,</span>&nbsp;<span style="color: #0550ae">13</span><span style="color: #24292f;background-color: #f6f8fa">);</span>
        </div><div class='code-line code-line-32'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #cf222e">var</span>&nbsp;<span style="color: #24292f;background-color: #f6f8fa">chunks</span>&nbsp;<span style="color: #0550ae">=</span>&nbsp;<span style="color: #24292f;background-color: #f6f8fa">[];</span>
        </div><div class='code-line code-line-33'>
        </div><div class='code-line code-line-34'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #cf222e">var</span>&nbsp;<span style="color: #24292f;background-color: #f6f8fa">offset</span>&nbsp;<span style="color: #0550ae">=</span>&nbsp;<span style="color: #0550ae">0</span><span style="color: #24292f;background-color: #f6f8fa">;</span>
        </div><div class='code-line code-line-35'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #cf222e">var</span>&nbsp;<span style="color: #24292f;background-color: #f6f8fa">bytes</span>&nbsp;<span style="color: #0550ae">=</span>&nbsp;<span style="color: #0550ae">0</span><span style="color: #24292f;background-color: #f6f8fa">;</span>
        </div><div class='code-line code-line-36'>
        </div><div class='code-line code-line-37'>
        </div><div class='code-line code-line-38'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #24292f;background-color: #f6f8fa">reader</span><span style="color: #24292f;background-color: #f6f8fa">.</span><span style="color: #24292f;background-color: #f6f8fa">onloadend</span>&nbsp;<span style="color: #0550ae">=</span>&nbsp;<span style="color: #cf222e">function</span><span style="color: #24292f;background-color: #f6f8fa">(</span><span style="color: #24292f;background-color: #f6f8fa">e</span><span style="color: #24292f;background-color: #f6f8fa">){</span>
        </div><div class='code-line code-line-39'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #cf222e">if </span><span style="color: #24292f;background-color: #f6f8fa">(</span><span style="color: #24292f;background-color: #f6f8fa">e</span><span style="color: #24292f;background-color: #f6f8fa">.</span><span style="color: #24292f;background-color: #f6f8fa">target</span><span style="color: #24292f;background-color: #f6f8fa">.</span><span style="color: #24292f;background-color: #f6f8fa">readyState</span>&nbsp;<span style="color: #0550ae">==</span>&nbsp;<span style="color: #24292f;background-color: #f6f8fa">FileReader</span><span style="color: #24292f;background-color: #f6f8fa">.</span><span style="color: #24292f;background-color: #f6f8fa">DONE</span><span style="color: #24292f;background-color: #f6f8fa">){</span>
        </div><div class='code-line code-line-40'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #cf222e">var</span>&nbsp;<span style="color: #24292f;background-color: #f6f8fa">chunk</span>&nbsp;<span style="color: #0550ae">=</span>&nbsp;<span style="color: #24292f;background-color: #f6f8fa">e</span><span style="color: #24292f;background-color: #f6f8fa">.</span><span style="color: #24292f;background-color: #f6f8fa">target</span><span style="color: #24292f;background-color: #f6f8fa">.</span><span style="color: #24292f;background-color: #f6f8fa">result</span><span style="color: #24292f;background-color: #f6f8fa">;</span>
        </div><div class='code-line code-line-41'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #24292f;background-color: #f6f8fa">bytes</span>&nbsp;<span style="color: #0550ae">+=</span>&nbsp;<span style="color: #24292f;background-color: #f6f8fa">chunk</span><span style="color: #24292f;background-color: #f6f8fa">.</span><span style="color: #24292f;background-color: #f6f8fa">length</span><span style="color: