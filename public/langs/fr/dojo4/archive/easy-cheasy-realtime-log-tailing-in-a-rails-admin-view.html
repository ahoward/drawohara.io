<html color-mode="user" lang="fr">
  <head>
  <!-- ga -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-DQVD9T27V4"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-DQVD9T27V4');
</script>

  <!-- deps -->
    <script type="module" src="/assets/js/turbo.es2017-esm.js" defer></script>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.fluid.classless.fuchsia.min.css"
    >

  <!-- defaults -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="color-scheme" content="light dark" />

  <!-- favicon -->
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">

  <!-- meta -->
    <title>suivi de journal en temps réel facile dans une vue admin rails</title>

<meta property="og:title" content="suivi de journal en temps réel facile dans une vue admin rails"/>
<meta property="og:description" content="circulez." />
<meta property="og:image" content="https://drawohara.io/media/mick.jpg" />

<meta property="og:image:type" content="image/jpeg" />

    <meta property="site:route" content=""/dojo4/archive/:id"">
    <meta property="site:params" content="{"ext":null,"id":"easy-cheasy-realtime-log-tailing-in-a-rails-admin-view"}">
    <meta property="site:path_info" content=""/easy-cheasy-realtime-log-tailing-in-a-rails-admin-view"">

    <base href="/fr" />

    <style>
      /* anti pico */
      a {text-decoration: none !important; }

      /* anti turbo */
      html { transition: none !important; }
      .turbo-progress-bar { visibility: hidden; }

      /* anti progressive */
      html { margin: 1em; }
      img { display: block; text-align: center; }
    </style>

    <script>
      document.addEventListener("turbo:load", function() {
        const progressBar = document.querySelector('.turbo-progress-bar');
        if (progressBar) {
          progressBar.remove();
        }
      });
    </script>
  </head>

  <body>
    <header>
      <a href="/accueil">@drawohara</a>
<hr>
    </header>

    <main>
      <div class="ro markdown">
  <p>dans nos applications rails, nous avons toujours une section ‘/su’ ou ‘super utilisateur’. nous y mettons des choses comme des rapports dans ce backend. récemment, j'ai eu besoin de permettre aux super utilisateurs de voir les journaux en temps réel depuis le navigateur (pour aider au débogage des problèmes de pare-feu pour un serveur de licence que nous avons construit). j'ai envisagé de faire quelque chose de malin comme les websockets, puis je suis devenu sain d'esprit et j'ai décidé de faire la chose la plus simple qui pourrait fonctionner - rappelez-vous, c'est pour les super utilisateurs seulement, donc l'approche de polling suivante est <em>juuuust parfait</em>…<br />
<br /><br />
<br /></p>

<p>la première étape consistait à configurer une action et une vue qui pouvaient suivre un journal, le montrer, puis le mettre à jour par ajax polling. la cerise sur le gâteau était d'ajouter une interface utilisateur sophistiquée (aka <em>lien</em>) qui pouvait démarrer et arrêter le polling<br />
<br /><br />
<br /></p>

<p>voici une grande partie du code pertinent<br />
<br /><br />
<br /></p>

<script src="https://gist.github.com/1994292.js?file=tail-f.rb"></script>

<p><br /><br />
<br /></p>

<p>la deuxième étape, montrée dans ce gist, consistait à calmer la fonction de journalisation récursive que j'ai ajoutée par inadvertance : aka - le polling ajax lui-même a créé des tonnes de sorties de journal.<br />
<br /></p>

<p>donc voilà. basse technologie. facile. k.i.s.s. suivi de journal pour les administrateurs.<br />
<br /><br />
<br /></p>

</div>
    </main>

    <footer>
      <hr>
<a href="/aller" name="aller">&mdash;&gt; aller</a>
<blockquote>
<ul>
  <li>
    <a href="/a-propos">à-propos</a>
  </li>
  <li>
    <a href="mailto:i-hate-this@drawohara.io?subject=/easy-cheasy-realtime-log-tailing-in-a-rails-admin-view">i-hate-this</a>
  </li>
  <li>
    <a href="mailto:i-love-this@drawohara.io?subject=/easy-cheasy-realtime-log-tailing-in-a-rails-admin-view">i-love-this</a>
  </li>
  <li>
    <a href="/contact">contact</a>
  </li>
</ul>
</blockquote>
<a href="/">&lt;&mdash; éjecter</a>
    </footer>
  </body>
</html>