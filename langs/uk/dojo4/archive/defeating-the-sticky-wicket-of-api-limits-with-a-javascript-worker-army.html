``
<html color-mode="user" lang="uk">
  <head>
  <!-- ga -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-DQVD9T27V4"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-DQVD9T27V4');
</script>

  <!-- deps -->
    <script type="module" src="/assets/js/turbo.es2017-esm.js" defer></script>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.fluid.classless.fuchsia.min.css"
    >

  <!-- langs -->
  <!--
    https://developers.google.com/search/docs/specialty/international/localized-versions#html
  -->
   <link rel="alternate" hreflang="en" href="/" />
   <link rel="alternate" hreflang="uk" href="https://drawohara.io/langs/uk" />
   <link rel="alternate" hreflang="sv" href="https://drawohara.io/langs/sv" />
   <link rel="alternate" hreflang="fr" href="https://drawohara.io/langs/fr" />
   <link rel="alternate" hreflang="es" href="https://drawohara.io/langs/es" />
   <link rel="alternate" hreflang="it" href="https://drawohara.io/langs/it" />

  <!-- defaults -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="color-scheme" content="light dark" />

  <!-- favicon -->
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">

  <!-- meta -->
    <title>—Ç—É—Ç –Ω—ñ—á–æ–≥–æ –Ω–µ–º–∞—î.</title>

<meta property="og:title" content="—Ç—É—Ç –Ω—ñ—á–æ–≥–æ –Ω–µ–º–∞—î."/>
<meta property="og:description" content="–ø—Ä–æ–¥–æ–≤–∂—É–π—Ç–µ —Ä—É—Ö." />
<meta property="og:image" content="https://drawohara.io/media/mick.jpg" />

<meta property="og:image:type" content="image/jpeg" />

    <meta property="site:route" content=""/dojo4/archive/:id"">
    <meta property="site:params" content="{"ext":null,"id":"defeating-the-sticky-wicket-of-api-limits-with-a-javascript-worker-army"}">
    <meta property="site:path_info" content=""/defeating-the-sticky-wicket-of-api-limits-with-a-javascript-worker-army"">

  <base href='/langs/uk' />

    <style>
      /* anti pico */
      a {text-decoration: none !important; }

      /* anti turbo */
      html { transition: none !important; }
      .turbo-progress-bar { visibility: hidden; }

      /* anti progressive */
      html { margin: 1em; }
      img { display: block; text-align: center; }
    </style>

    <script>
      document.addEventListener("turbo:load", function() {
        const progressBar = document.querySelector('.turbo-progress-bar');
        if (progressBar) { progressBar.remove(); }
      });
    </script>
  </head>

  <body>
    <header>
      <a href="/goto">@drawohara</a> &mdash;
<a href="mailto:i-love-this@drawohara.io?subject=/defeating-the-sticky-wicket-of-api-limits-with-a-javascript-worker-army">—è ‚ù§Ô∏è —Ü–µ!</a>
<small>
  <small>
    <small>
      <span title='–≤–∏–ø–∏–π –º–µ–Ω–µ'>&lt;&lt; –Ω–∞—Ç–∏—Å–Ω—ñ—Ç—å –º–µ–Ω–µ üêõ ü´ñ üßö</span>
    </small>
  </small>
</small>
<hr>
<strong>/defeating-the-sticky-wicket-of-api-limits-with-a-javascript-worker-army</strong>
    </header>

    <main>
      <em>–æ–ø—É–±–ª—ñ–∫–æ–≤–∞–Ω–æ: 2013-11-12</em>
<br>
<br>
<div class="ro markdown">
  <h2 id="tldr">TL;DR</h2>

<p>–∫–æ–ª–∏ —É –≤–∞—Å <em>–¥—É–∂–µ</em> –±–∞–≥–∞—Ç–æ —Ä–æ–±–æ—Ç–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä—ñ —á–µ—Ä–µ–∑ –æ–±–º–µ–∂–µ–Ω–Ω—è API</p>

<p>–ø–µ—Ä–µ–¥–∞–π—Ç–µ —á–∞—Å—Ç–∏–Ω—É —Ä–æ–±–æ—Ç–∏ –∫–ª—ñ—î–Ω—Ç–∞–º –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è - –≤—ñ–¥–ø—Ä–∞–≤—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏ –Ω–∞–∑–∞–¥ –¥–æ –≤–∞—à–æ—ó –±–∞–∑–∏ –¥–∞–Ω–∏—Ö</p>

<h2 id="the-problem">–ø—Ä–æ–±–ª–µ–º–∞</h2>
<p>–º–∏–Ω—É–ª–æ–≥–æ —Ç–∏–∂–Ω—è —è –º–∞–≤ —Å–ø—Ä–∞–≤—É –∑ (g-provider) –æ–±–º–µ–∂–µ–Ω–Ω—è–º–∏ API —Ç–∞ –Ω–∞–¥—Ç–æ –≤–µ–ª–∏–∫–æ—é –∫—ñ–ª—å–∫—ñ—Å—Ç—é –∑–∞–ø–∏—Ç—ñ–≤ –Ω–∞ –≥–µ–æ–ª–æ–∫–∞—Ü—ñ—é, —â–æ –Ω–∞–¥—Ö–æ–¥–∏–ª–∏ –∑ —Å–µ—Ä–≤–µ—Ä–∞(—ñ–≤). –Ø —Ç—Ä–æ—Ö–∏ –ø–æ–ø—Ä–∞—Ü—é–≤–∞–≤ –Ω–∞–¥ —Ü–∏–º, –≤–∏–∫–æ–Ω—É—é—á–∏ —Ä–µ—á—ñ –Ω–∞ –∑–∞–¥–Ω—å–æ–º—É –ø–ª–∞–Ω—ñ –∑ –ø–µ—Ä—ñ–æ–¥–∏—á–Ω–∏–º–∏ –ø–æ–≤—Ç–æ—Ä–Ω–∏–º–∏ —Å–ø—Ä–æ–±–∞–º–∏ - –≤–∏ –∑–Ω–∞—î—Ç–µ: —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ñ —Ä–µ—á—ñ‚Ä¶</p>

<p>API, –ø—Ä–æ —è–∫–µ –π–¥–µ—Ç—å—Å—è, –æ–±–º–µ–∂—É—î—Ç—å—Å—è –∑–∞ IP, —ñ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è —Ä–µ–∫–æ–º–µ–Ω–¥—É—î —Å–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏—Å—è —Ü–∏–º, –≤–∏–∫–æ–Ω—É—é—á–∏ –±—ñ–ª—å—à—ñ—Å—Ç—å –≤–∏–∫–ª–∏–∫—ñ–≤ API –Ω–∞ —Å—Ç–æ—Ä–æ–Ω—ñ –∫–ª—ñ—î–Ω—Ç–∞ - —É js.</p>

<p>–¢–µ–ø–µ—Ä, —É —Ü—å–æ–º—É –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É –≤–∏–ø–∞–¥–∫—É –º–µ–Ω—ñ –∞–±—Å–æ–ª—é—Ç–Ω–æ <em>–ø–æ—Ç—Ä—ñ–±–Ω–æ</em> –±—É–ª–æ, —â–æ–± —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏ –≤–∏–∫–ª–∏–∫—ñ–≤ API –∑–Ω–∞—Ö–æ–¥–∏–ª–∏—Å—è –Ω–∞ —Å—Ç–æ—Ä–æ–Ω—ñ —Å–µ—Ä–≤–µ—Ä–∞, —Ç–æ–º—É —è –∑—É–ø–∏–Ω–∏–≤—Å—è –Ω–∞ —Ü—å–æ–º—É –∫–æ–º–ø—Ä–æ–º—ñ—Å–Ω–æ–º—É (—É –∫—ñ–ª—å–∫–æ—Ö —Å–µ–Ω—Å–∞—Ö) —Ä—ñ—à–µ–Ω–Ω—ñ</p>

<h2 id="the-solution">—Ä—ñ—à–µ–Ω–Ω—è</h2>
<p>–ø—Ä–∏–ø—É—Å—Ç—ñ–º–æ, —â–æ –¥–µ—è–∫—ñ –∫–ª—ñ—î–Ω—Ç–∏ –≥–æ—Ç–æ–≤—ñ –≤–∏—Ç—Ä–∞—á–∞—Ç–∏ —Å–≤—ñ–π –ø—Ä–æ—Ü–µ—Å–æ—Ä–Ω–∏–π —á–∞—Å –Ω–∞ –∑–∞–ø–æ–≤–Ω–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö, —è–∫—ñ —ó—Ö —Ü—ñ–∫–∞–≤–ª—è—Ç—å. –ü—Ä–æ—Å—Ç–∏–º–∏ —Å–ª–æ–≤–∞–º–∏, –∑–º—É—Å—ñ—Ç—å –¥–µ—è–∫–∏—Ö —Å–≤–æ—ó—Ö –∫–ª—ñ—î–Ω—Ç—ñ–≤ –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏ –∑–∞–≤–¥–∞–Ω–Ω—è –∑ —á–µ—Ä–≥–∏ JavaScript, —â–æ–± –ø—ñ–¥–≥–æ—Ç—É–≤–∞—Ç–∏ –Ω–∞—Å–æ—Å, –∑ —è–∫–æ–≥–æ –≤–æ–Ω–∏ —Ö–æ—á—É—Ç—å –ø–∏—Ç–∏.</p>

<p>—É –º–æ—î–º—É –≤–∏–ø–∞–¥–∫—É –ø–µ–≤–Ω—ñ –≤–∏–±—Ä–∞–Ω—ñ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∏ (—Ü—ñ–∫–∞–≤—ñ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ —Ü–∏—Ö —Ä–æ–±—ñ—Ç) –≤–∏–∫–æ–Ω—É—é—Ç—å –º–∞–ª–µ–Ω—å–∫–∏–π iframe</p>

<div class="language-html highlighter-rouge"><code class='code' style='white-space:pre;'><div class='code-line code-line-1'>
</div><div class='code-line code-line-2'><span style="color: #6e7781">&lt;!-- –≤—Å—Ç–∞–≤—Ç–µ –≤–∏–∫–æ–Ω–∞–≤—Ü—è —á–µ—Ä–≥–∏ –∑–∞–≤–¥–∞–Ω—å –Ω–∞ –ø–µ–≤–Ω—ñ —Å—Ç–æ—Ä—ñ–Ω–∫–∏/–ø–µ—Ä–µ–≥–ª—è–¥–∏/–º–∞–∫–µ—Ç–∏ --&gt;</span>
</div><div class='code-line code-line-3'>
</div><div class='code-line code-line-4'><span style="color: #116329">&lt;iframe</span>&nbsp;<span style="color: #116329">height=</span><span style="color: #0a3069">"0"</span>&nbsp;<span style="color: #116329">width=</span><span style="color: #0a3069">"0"</span>&nbsp;<span style="color: #116329">style=</span><span style="color: #0a3069">"display:none;"</span>&nbsp;<span style="color: #116329">src=</span><span style="color: #0a3069">"/javascript_jobs/runner"</span><span style="color: #116329">&gt;&lt;/iframe&gt;</span>
</div><div class='code-line code-line-5'>
</div><div class='code-line code-line-6'>
</div></code></div>

<div class="language-erb highlighter-rouge"><code class='code' style='white-space:pre;'><div class='code-line code-line-1'>
</div><div class='code-line code-line-2'><span style="color: #6e7781">&lt;!-- –≤–∏–∫–æ–Ω–∞–≤–µ—Ü—å –∑–∞–≤–¥–∞–Ω—å --&gt;</span>
</div><div class='code-line code-line-3'>
</div><div class='code-line code-line-4'><span style="color: #6e7781">&lt;%=</span>&nbsp;<span style="color: #24292f;background-color: #f6f8fa">javascript_include_tag</span>&nbsp;<span style="color: #0a3069">:jquery</span>&nbsp;<span style="color: #6e7781">%&gt;</span>
</div><div class='code-line code-line-5'><span style="color: #6e7781">&lt;%=</span>&nbsp;<span style="color: #24292f;background-color: #f6f8fa">javascript_include_tag</span>&nbsp;<span style="color: #0a3069">:jobs</span>&nbsp;<span style="color: #6e7781">%&gt;</span>
</div><div class='code-line code-line-6'>
</div><div class='code-line code-line-7'><span style="color: #116329">&lt;script&gt;</span>
</div><div class='code-line code-line-8'>&nbsp;&nbsp;<span style="color: #8250df">jQuery</span><span style="color: #24292f;background-color: #f6f8fa">(</span><span style="color: #cf222e">function</span><span style="color: #24292f;background-color: #f6f8fa">(){</span>
</div><div class='code-line code-line-9'>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #24292f;background-color: #f6f8fa">jobs</span><span style="color: #24292f;background-color: #f6f8fa">.</span><span style="color: #24292f;background-color: #f6f8fa">complete</span>&nbsp;<span style="color: #0550ae">=</span>&nbsp;<span style="color: #cf222e">function</span><span style="color: #24292f;background-color: #f6f8fa">(</span><span style="color: #24292f;background-color: #f6f8fa">job</span><span style="color: #24292f;background-color: #f6f8fa">){</span>
</div><div class='code-line code-line-10'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #953800">document</span><span style="color: #24292f;background-color: #f6f8fa">.</span><span style="color: #8250df">write</span><span style="color: #24292f;background-color: #f6f8fa">(</span><span style="color: #0a3069">'</span><span style="color: #0a3069">–∑–∞–≤–µ—Ä—à–µ–Ω–æ </span><span style="color: #0a3069">'</span>&nbsp;<span style="color: #0550ae">+</span>&nbsp;<span style="color: #24292f;background-color: #f6f8fa">job</span><span style="color: #24292f;background-color: #f6f8fa">.</span><span style="color: #24292f;background-color: #f6f8fa">id</span><span style="color: #24292f;background-color: #f6f8fa">);</span>
</div><div class='code-line code-line-11'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #953800">document</span><span style="color: #24292f;background-color: #f6f8fa">.</span><span style="color: #24292f;background-color: #f6f8fa">write</span><span style="color: #24292f;background-color: #f6f8fa">(</span><span style="color: #0a3069">'</span><span style="color: #0a3069">&lt;br&gt;</span><span style="color: #0a3069">'</span><span style="color: #24292f;background-color: #f6f8fa">);</span>
</div><div class='code-line code-line-12'>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #24292f;background-color: #f6f8fa">};</span>
</div><div class='code-line code-line-13'>
</div><div class='code-line code-line-14'>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #8250df">setTimeout</span><span style="color: #24292f;background-color: #f6f8fa">(</span><span style="color: #cf222e">function</span><span style="color: #24292f;background-color: #f6f8fa">(){</span>&nbsp;<span style="color: #24292f;background-color: #f6f8fa">jobs</span><span style="color: #24292f;background-color: #f6f8fa">.</span><span style="color: #8250df">start</span><span style="color: #24292f;background-color: #f6f8fa">();</span>&nbsp;<span style="color: #24292f;background-color: #f6f8fa">},</span>&nbsp;<span style="color: #0550ae">1000</span><span style="color: #24292f;background-color: #f6f8fa">);</span>
</div><div class='code-line code-line-15'>&nbsp;&nbsp;<span style="color: #24292f;background-color: #f6f8fa">});</span>
</div><div class='code-line code-line-16'><span style="color: #116329">&lt;/script&gt;</span>
</div><div class='code-line code-line-17'>
</div><div class='code-line code-line-18'>
</div></code></div>

<p>JS, –Ω–µ–æ–±—Ö—ñ–¥–Ω–∏–π –¥–ª—è –≤–∑–∞—î–º–æ–¥—ñ—ó –∑ —á–µ—Ä–≥–æ—é –∑–∞–≤–¥–∞–Ω—å, –∫–æ—Ä–æ—Ç–∫–∏–π —ñ –ø—Ä–æ—Å—Ç–∏–π</p>

<p>–≤—Å–µ, —â–æ –≤—ñ–Ω —Ä–æ–±–∏—Ç—å - —Ü–µ –æ—Ç—Ä–∏–º—É—î –∑–∞–≤–¥–∞–Ω–Ω—è, –≤–∏–∫–æ–Ω—É—î –π–æ–≥–æ —Ç–∞ –≤—ñ–¥–ø—Ä–∞–≤–ª—è—î –Ω–∞–∑–∞–¥ –Ω–∞ —Å–µ—Ä–≤–µ—Ä - –¥–æ—Ç—Ä–∏–º—É—é—á–∏—Å—å —è–∫ –ø—Ä–æ–ø—É—Å–∫–Ω–æ—ó –∑–¥–∞—Ç–Ω–æ—Å—Ç—ñ, —Ç–∞–∫ —ñ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ—ó –∫—ñ–ª—å–∫–æ—Å—Ç—ñ –∑–∞–≤–¥–∞–Ω—å –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è.</p>

<div class="language-javascript highlighter-rouge"><code class='code' style='white-space:pre;'><div class='code-line code-line-1'>
</div><div class='code-line code-line-2'><span style="color: #cf222e">if</span><span style="color: #24292f;background-color: #f6f8fa">(</span><span style="color: #0550ae">!</span><span style="color: #953800">window</span><span style="color: #24292f;background-color: #f6f8fa">.</span><span style="color: #24292f;background-color: #f6f8fa">jobs</span><span style="color: #24292f;background-color: #f6f8fa">){</span>
</div><div class='code-line code-line-3'><span style="color: #6e7781">//</span>
</div><div class='code-line code-line-4'>&nbsp;&nbsp;<span style="color: #953800">window</span><span style="color: #24292f;background-color: #f6f8fa">.</span><span style="color: #24292f;background-color: #f6f8fa">jobs</span>&nbsp;<span style="color: #0550ae">=</span>&nbsp;<span style="color: #24292f;background-color: #f6f8fa">{};</span>
</div><div class='code-line code-line-5'>&nbsp;&nbsp;<span style="color: #953800">window</span><span style="color: #24292f;background-color: #f6f8fa">.</span><span style="color: #24292f;background-color: #f6f8fa">jobs</span><span style="color: #24292f;background-color: #f6f8fa">.</span><span style="color: #24292f;background-color: #f6f8fa">count</span>&nbsp;<span style="color: #0550ae">=</span>&nbsp;<span style="color: #0550ae">0</span><span style="color: #24292f;background-color: #f6f8fa">;</span>
</div><div class='code-line code-line-6'>&nbsp;&nbsp;<span style="color: #953800">window</span><span style="color: #24292f;background-color: #f6f8fa">.</span><span style="color: #24292f;background-color: #f6f8fa">jobs</span><span style="color: #24292f;background-color: #f6f8fa">.</span><span style="color: #24292f;background-color: #f6f8fa">max</span>&nbsp;<span style="color: #0550ae">=</span>&nbsp;<span style="color: #0550ae">256</span><span style="color: #24292f;background-color: #f6f8fa">;</span>
</div><div class='code-line code-line-7'>&nbsp;&nbsp;<span style="color: #953800">window</span><span style="color: #24292f;background-color: #f6f8fa">.</span><span style="color: #24292f;background-color: #f6f8fa">jobs</span><span style="color: #24292f;background-color: #f6f8fa">.</span><span style="color: #24292f;background-color: #f6f8fa">throttle</span>&nbsp;<span style="color: #0550ae">=</span>&nbsp;<span style="color: #0550ae">1000</span><span style="color: #24292f;background-color: #f6f8fa">;</span>
</div><div class='code-line code-line-8'>&nbsp;&nbsp;<span style="color: #953800">window</span><span style="color: #24292f;background-color: #f6f8fa">.</span><span style="color: #24292f;background-color: #f6f8fa">jobs</span><span style="color: #24292f;background-color: #f6f8fa">.</span><span style="color: #24292f;background-color: #f6f8fa">complete</span>&nbsp;<span style="color: #0550ae">=</span>&nbsp;<span style="color: #cf222e">function</span><span style="color: #24292f;background-color: #f6f8fa">(){};</span>
</div><div class='code-line code-line-9'>
</div><div class='code-line code-line-10'><span style="color: #6e7781">//</span>
</div><div class='code-line code-line-11'>&nbsp;&nbsp;<span style="color: #24292f;background-color: #f6f8fa">jobs</span><span style="color: #24292f;background-color: #f6f8fa">.</span><span style="color: #24292f;background-color: #f6f8fa">get_next_job</span>&nbsp;<span style="color: #0550ae">=</span>&nbsp;<span style="color: #cf222e">function</span><span style="color: #24292f;background-color: #f6f8fa">(){</span>
</div><div class='code-line code-line-12'>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #cf222e">var</span>&nbsp;<span style="color: #24292f;background-color: #f6f8fa">success</span>&nbsp;<span style="color: #0550ae">=</span>&nbsp;<span style="color: #cf222e">function</span><span style="color: #24292f;background-color: #f6f8fa">(</span><span style="color: #24292f;background-color: #f6f8fa">response</span><span style="color: #24292f;background-color: #f6f8fa">){</span>
</div><div class='code-line code-line-13'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #24292f;background-color: #f6f8fa">job</span>&nbsp;<span style="color: #0550ae">=</span>&nbsp;<span style="color: #24292f;background-color: #f6f8fa">response</span><span style="color: #24292f;background-color: #f6f8fa">[</span><span style="color: #0a3069">'</span><span style="color: #0a3069">data</span><span style="color: #0a3069">'</span><span style="color: #24292f;background-color: #f6f8fa">][</span><span style="color: #0a3069">'</span><span style="color: #0a3069">job</span><span style="color: #0a3069">'</span><span style="color: #24292f;background-color: #f6f8fa">];</span>
</div><div class='code-line code-line-14'>
</div><div class='code-line code-line-15'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #cf222e">if</span><span style="color: #24292f;background-color: #f6f8fa">(</span><span style="color: #24292f;background-color: #f6f8fa">job</span><span style="color: #24292f;background-color: #f6f8fa">){</span>
</div><div class='code-line code-line-16'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #24292f;background-color: #f6f8fa">jobs</span><span style="color: #24292f;background-color: #f6f8fa">.</span><span style="color: #24292f;background-color: #f6f8fa">count</span><span style="color: #0550ae">++</span><span style="color: #24292f;background-color: #f6f8fa">;</span>
</div><div class='code-line code-line-17'>
</div><div class='code-line code-line-18'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #24292f;background-color: #f6f8fa">jobs</span><span style="color: #24292f;background-color: #f6f8fa">.</span><span style="color: #8250df">run</span><span style="color: #24292f;background-color: #f6f8fa">(</span><span style="color: #24292f;background-color: #f6f8fa">job</span><span style="color: #24292f;background-color: #f6f8fa">,</span>&nbsp;<span style="color: #cf222e">function</span><span style="color: #24292f;background-color: #f6f8fa">(</span><span style="color: #24292f;background-color: #f6f8fa">job</span><span style="color: #24292f;background-color: #f6f8fa">){</span>
</div><div class='code-line code-line-19'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #cf222e">if</span><span style="color: #24292f;background-color: #f6f8fa">(</span><span style="color: #24292f;background-color: #f6f8fa">jobs</span><span style="color: #24292f;background-color: #f6f8fa">.</span><span style="color: #24292f;background-color: #f6f8fa">count</span>&nbsp;<span style="color: #0550ae">&lt;</span>&nbsp;<span style="color: #24292f;background-color: #f6f8fa">jobs</span><span style="color: #24292f;background-color: #f6f8fa">.</span><span style="color: #24292f;background-color: #f6f8fa">max</span><span style="color: #24292f;background-color: #f6f8fa">){</span>
</div><div class='code-line code-line-20'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #8250df">setTimeout</span><span style="color: #24292f;background-color: #f6f8fa">(</span><span style="color: #24292f;background-color: #f6f8fa">jobs</span><span style="color: #24292f;background-color: #f6f8fa">.</span><span style="color: #24292f;background-color: #f6f8fa">get_next_job</span><span style="color: #24292f;background-color: #f6f8fa">,</span>&nbsp;<span style="color: #24292f;background-color: #f6f8fa">jobs</span><span style="color: #24292f;background-color: #f6f8fa">.</span><span style="color: #24292f;background-color: #f6f8fa">throttle</span><span style="color: #24292f;background-color: #f6f8fa">);</span>
</div><div class='code-line code-line-21'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #24292f;background-color: #f6f8fa">}</span>
</div><div class='code-line code-line-22'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #24292f;background-color: #f6f8fa">});</span>
</div><div class='code-line code-line-23'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #24292f;background-color: #f6f8fa">}</span>
</div><div class='code-line code-line-24'>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #24292f;background-color: #f6f8fa">};</span>
</div><div class='code-line code-line-25'>
</div><div class='code-line code-line-26'>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #24292f;background-color: #f6f8fa">jQuery</span><span style="color: #24292f;background-color: #f6f8fa">.</span><span style="color: #8250df">ajax</span><span style="color: #24292f;background-color: #f6f8fa">({</span>
</div><div class='code-line code-line-27'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #0a3069">'</span><span style="color: #0a3069">url</span><span style="color: #0a3069">'</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #24292f;background-color: #f6f8fa">:</span>&nbsp;<span style="color: #0a3069">'</span><span style="color: #0a3069">/api/jobs/next</span><span style="color: #0a3069">'</span><span style="color: #24292f;background-color: #f6f8fa">,</span>
</div><div class='code-line code-line-28'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #0a3069">'</span><span style="color: #0a3069">type</span><span style="color: #0a3069">'</span>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #24292f;background-color: #f6f8fa">:</span>&nbsp;<span style="color: #0a3069">'</span><span style="color: #0a3069">GET</span><span style="color: #0a3069">'</span><span style="color: #24292f;background-color: #f6f8fa">,</span>
</div><div class='code-line code-line-29'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #0a3069">'</span><span style="color: #0a3069">cache</span><span style="color: #0a3069">'</span>&nbsp;&nbsp;&nbsp;<span style="color: #24292f;background-color: #f6f8fa">:</span>&nbsp;<span style="color: #0550ae">false</span><span style="color: #24292f;background-color: #f6f8fa">,</span>
</div><div class='code-line code-line-30'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #0a3069">'</span><span style="color: #0a3069">success</span><span style="color: #0a3069">'</span>&nbsp;<span style="color: #24292f;background-color: #f6f8fa">:</span>&nbsp;<span style="color: #24292f;background-color: #f6f8fa">success</span>
</div><div class='code-line code-line-31'>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #24292f;background-color: #f6f8fa">});</span>
</div><div class='code-line code-line-32'>&nbsp;&nbsp;<span style="color: #24292f;background-color: #f6f8fa">};</span>
</div><div class='code-line code-line-33'>
</div><div class='code-line code-line-34'><span style="color: #6e7781">//</span>
</div><div class='code-line code-line-35'>&nbsp;&nbsp;<span style="color: #24292f;background-color: #f6f8fa">jobs</span><span style="color: #24292f;background-color: #f6f8fa">.</span><span style="color: #24292f;background-color: #f6f8fa">run</span>&nbsp;<span style="color: #0550ae">=</span>&nbsp;<span style="color: #cf222e">function</span><span style="color: #24292f;background-color: #f6f8fa">(</span><span style="color: #24292f;background-color: #f6f8fa">job</span><span style="color: #24292f;background-color: #f6f8fa">,</span>&nbsp;<span style="color: #24292f;background-color: #f6f8fa">callback</span><span style="color: #24292f;background-color: #f6f8fa">){</span>
</div><div class='code-line code-line-36'>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #cf222e">var</span>&nbsp;<span style="color: #24292f;background-color: #f6f8fa">code</span>&nbsp;<span style="color: #0550ae">=</span>&nbsp;<span style="color: #24292f;background-color: #f6f8fa">job</span><span style="color: #24292f;background-color: #f6f8fa">[</span><span style="color: #0a3069">'</span><span style="color: #0a3069">code</span><span style="color: #0a3069">'</span><span style="color: #24292f;background-color: #f6f8fa">];</span>
</div><div class='code-line code-line-37'>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #cf222e">var</span>&nbsp;<span style="color: #24292f;background-color: #f6f8fa">result</span>&nbsp;<span style="color: #0550ae">=</span>&nbsp;<span style="color: #0550ae">undefined</span><span style="color: #24292f;background-color: #f6f8fa">;</span>
</div><div class='code-line code-line-38'>
</div><div class='code-line code-line-39'>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #24292f;background-color: #f6f8fa">callback</span>&nbsp;<span style="color: #0550ae">=</span>&nbsp;<span style="color: #24292f;background-color: #f6f8fa">callback</span>&nbsp;<span style="color: #0550ae">||</span>&nbsp;<span style="color: #cf222e">function</span><span style="color: #24292f;background-color: #f6f8fa">(){};</span>
</div><div class='code-line code-line-40'>
</div><div class='code-line code-line-41'>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #cf222e">if</span><span style="color: #24292f;background-color: #f6f8fa">(</span><span style="color: #24292f;background-color: #f6f8fa">code</span><span style="color: #24292f;background-color: #f6f8fa">){</span>
</div><div class='code-line code-line-42'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #cf222e">try</span><span style="color: #24292f;background-color: #f6f8fa">{</span>
</div><div class='code-line code-line-43'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #24292f;background-color: #f6f8fa">(</span><span style="color: #cf222e">function</span><span style="color: #24292f;background-color: #f6f8fa">(){</span>
</div><div class='code-line code-line-44'>
</div><div class='code-line code-line-45'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #24292f;background-color: #f6f8fa">job</span><span style="color: #24292f;background-color: #f6f8fa">[</span><span style="color: #0a3069">'</span><span style="color: #0a3069">result</span><span style="color: #0a3069">'</span><span style="color: #24292f;background-color: #f6f8fa">]</span>&nbsp;<span style="color: #0550ae">=</span>&nbsp;<span style="color: #8250df">eval</span><span style="color: #24292f;background-color: #f6f8fa">(</span><span style="color: #24292f;background-color: #f6f8fa">code</span><span style="color: #24292f;background-color: #f6f8fa">);</span>
</div><div class='code-line code-line-46'>
</div><div class='code-line code-line-47'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #24292f;background-color: #f6f8fa">})()</span>
</div><div class='code-line code-line-48'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #24292f;background-color: #f6f8fa">}</span>&nbsp;<span style="color: #cf222e">catch</span><span style="color: #24292f;background-color: #f6f8fa">(</span><span style="color: #24292f;background-color: #f6f8fa">e</span><span style="color: #24292f;background-color: #f6f8fa">)</span>&nbsp;<span style="color: #24292f;background-color: #f6f8fa">{};</span>
</div><div class='code-line code-line-49'>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #24292f;background-color: #f6f8fa">}</span>
</div><div class='code-line code-line-50'>
</div><div class='code-line code-line-51'>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #cf222e">var</span>&nbsp;<span style="color: #24292f;background-color: #f6f8fa">url</span>&nbsp;<span style="color: #0550ae">=</span>&nbsp;<span style="color: #0a3069">'</span><span style="color: #0a3069">/api/jobs/:id</span><span style="color: #0a3069">'</span><span style="color: #24292f;background-color: #f6f8fa">.</span><span style="color: #8250df">replace</span><span style="color: #24292f;background-color: #f6f8fa">(</span><span style="color: #116329">/:id/</span><span style="color: #24292f;background-color: #f6f8fa">,</span>&nbsp;<span style="color: #24292f;background-color: #f6f8fa">job</span><span style="color: #24292f;background-color: #f6f8fa">[</span><span style="color: #0a3069">'</span><span style="color: #0a3069">id</span><span style="color: #0a3069">'</span><span style="color: #24292f;background-color: #f6f8fa">]);</span>
</div><div class='code-line code-line-52'>
</div><div class='code-line code-line-53'>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #cf222e">var</span>&nbsp;<span style="color: #24292f;background-color: #f6f8fa">data</span>&nbsp;<span style="color: #0550ae">=</span>&nbsp;<span style="color: #24292f;background-color: #f6f8fa">{</span><span style="color: #0a3069">'</span><span style="color: #0a3069">job</span><span style="color: #0a3069">'</span>&nbsp;<span style="color: #24292f;background-color: #f6f8fa">:</span>&nbsp;<span style="color: #24292f;background-color: #f6f8fa">job</span><span style="color: #24292f;background-color: #f6f8fa">};</span>
</div><div class='code-line code-line-54'>
</div><div class='code-line code-line-55'>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #cf222e">var</span>&nbsp;<span style="color: #24292f;background-color: #f6f8fa">success</span>&nbsp;<span style="color: #0550ae">=</span>&nbsp;<span style="color: #cf222e">function</span><span style="color: #24292f;background-color: #f6f8fa">(</span><span style="color: #24292f;background-color: #f6f8fa">response</span><span style="color: #24292f;background-color: #f6f8fa">){</span>
</div><div class='code-line code-line-56'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #24292f;background-color: #f6f8fa">job</span>&nbsp;<span style="color: #0550ae">=</span>&nbsp;<span style="color: #24292f;background-color: #f6f8fa">response</span><span style="color: #24292f;background-color: #f6f8fa">[</span><span style="color: #0a3069">'</span><span style="color: #0a3069">data</span><span style="color: #0a3069">'</span><span style="color: #24292f;background-color: #f6f8fa">][</span><span style="color: #0a3069">'</span><span style="color: #0a3069">job</span><span style="color: #0a3069">'</span><span style="color: #24292f;background-color: #f6f8fa">];</span>
</div><div class='code-line code-line-57'>
</div><div class='code-line code-line-58'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #cf222e">try</span><span style="color: #24292f;background-color: #f6f8fa">{</span>
</div><div class='code-line code-line-59'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #24292f;background-color: #f6f8fa">jobs</span><span style="color: #24292f;background-color: #f6f8fa">.</span><span style="color: #8250df">complete</span><span style="color: #24292f;background-color: #f6f8fa">(</span><span style="color: #24292f;background-color: #f6f8fa">job</span><span style="color: #24292f;background-color: #f6f8fa">);</span>
</div><div class='code-line code-line-60'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #24292f;background-color: #f6f8fa">}</span>&nbsp;<span style="color: #cf222e">catch</span><span style="color: #24292f;background-color: #f6f8fa">(</span><span style="color: #24292f;background-color: #f6f8fa">e</span><span style="color: #24292f;background-color: #f6f8fa">){};</span>
</div><div class='code-line code-line-61'>
</div><div class='code-line code-line-62'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #cf222e">try</span><span style="color: #24292f;background-color: #f6f8fa">{</span>
</div><div class='code-line code-line-63'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #8250df">callback</span><span style="color: #24292f;background-color: #f6f8fa">(</span><span style="color: #24292f;background-color: #f6f8fa">job</span><span style="color: #24292f;background-color: #f6f8fa">);</span>
</div><div class='code-line code-line-64'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #24292f;background-color: #f6f8fa">}</span>&nbsp;<span style="color: #cf222e">catch</span><span style="color: #24292f;background-color: #f6f8fa">(</span><span style="color: #24292f;background-color: #f6f8fa">e</span><span style="color: #24292f;background-color: #f6f8fa">){};</span>
</div><div class='code-line code-line-65'>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #24292f;background-color: #f6f8fa">};</span>
</div><div class='code-line code-line-66'>
</div><div class='code-line code-line-67'>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #24292f;background-color: #f6f8fa">jQuery</span><span style="color: #24292f;background-color: #f6f8fa">.</span><span style="color: #8250df">ajax</span><span style="color: #24292f;background-color: #f6f8fa">({</span>
</div><div class='code-line code-line-68'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #0a3069">'</span><span style="color: #0a3069">url</span><span style="color: #0a3069">'</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #24292f;background-color: #f6f8fa">:</span>&nbsp;<span style="color: #24292f;background-color: #f6f8fa">url</span><span style="color: #24292f;background-color: #f6f8fa">,</span>
</div><div class='code-line code-line-69'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #0a3069">'</span><span style="color: #0a3069">type</span><span style="color: #0a3069">'</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #24292f;background-color: #f6f8fa">:</span>&nbsp;<span style="color: #0a3069">'</span><span style="color: #0a3069">PUT</span><span style="color: #0a3069">'</span><span style="color: #24292f;background-color: #f6f8fa">,</span>
</div><div class='code-line code-line-70'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #0a3069">'</span><span style="color: #0a3069">cache</span><span style="color: #0a3069">'</span>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #24292f;background-color: #f6f8fa">:</span>&nbsp;<span style="color: #0550ae">false</span><span style="color: #24292f;background-color: #f6f8fa">,</span>
</div><div class='code-line code-line-71'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #0a3069">'</span><span style="color: #0a3069">data</span><span style="color: #0a3069">'</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #24292f;background-color: #f6f8fa">:</span>&nbsp;<span style="color: #24292f;background-color: #f6f8fa">{</span><span style="color: #0a3069">'</span><span style="color: #0a3069">job</span><span style="color: #0a3069">'</span>&nbsp;&nbsp;<span style="color: #24292f;background-color: #f6f8fa">:</span>&nbsp;<span style="color: #24292f;background-color: #f6f8fa">job</span><span style="color: #24292f;background-color: #f6f8fa">},</span>
</div><div class='code-line code-line-72'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #0a3069">'</span><span style="color: #0a3069">dataType</span><span style="color: #0a3069">'</span>&nbsp;<span style="color: #24292f;background-color: #f6f8fa">:</span>&nbsp;<span style="color: #0a3069">'</span><span style="color: #0a3069">json</span><span style="color: #0a3069">'</span><span style="color: #24292f;background-color: #f6f8fa">,</span>
</div><div class='code-line code-line-73'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #0a3069">'</span><span style="color: #0a3069">success</span><span style="color: #0a3069">'</span>&nbsp;&nbsp;<span style="color: #24292f;background-color: #f6f8fa">:</span>&nbsp;<span style="color: #24292f;background-color: #f6f8fa">success</span>
</div><div class='code-line code-line-74'>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #24292f;background-color: #f6f8fa">});</span>
</div><div class='code-line code-line-75'>&nbsp;&nbsp;<span style="color: #24292f;background-color: #f6f8fa">};</span>
</div><div class='code-line code-line-76'>
</div><div class='code-line code-line-77'><span style="color: #6e7781">//</span>
</div><div class='code-line code-line-78'>&nbsp;&nbsp;<span style="color: #24292f;background-color: #f6f8fa">jobs</span><span style="color: #24292f;background-color: #f6f8fa">.</span><span style="color: #24292f;background-color: #f6f8fa">start</span>&nbsp;<span style="color: #0550ae">=</span>&nbsp;<span style="color: #24292f;background-color: #f6f8fa">jobs</span><span style="color: #24292f;background-color: #f6f8fa">.</span><span style="color: #24292f;background-color: #f6f8fa">get_next_job</span><span style="color: #24292f;background-color: #f6f8fa">;</span>
</div><div class='code-line code-line-79'><span style="color: #24292f;background-color: #f6f8fa">}</span>
</div><div class='code-line code-line-80'>
</div><div class='code-line code-line-81'>
</div></code></div>

<p>–¶—è –º–æ–¥–µ–ª—å –¥–æ–∑–≤–æ–ª—è—î –Ω–∞–º –ø–µ—Ä–µ–¥–∞—Ç–∏ –∑–∞–≤–¥–∞–Ω–Ω—è –∫–ª—ñ—î–Ω—Ç—É, —ñ —è–∫—â–æ –≤—ñ–Ω –Ω–µ –≤—ñ–¥–ø–æ–≤—ñ—Å—Ç—å –ø—Ä–æ—Ç—è–≥–æ–º –ø–µ–≤–Ω–æ–≥–æ —á–∞—Å—É, –º–∏ –ø—Ä–∏–ø—É—Å–∫–∞—î–º–æ, —â–æ —ñ–Ω—à–∏–π –∫–ª—ñ—î–Ω—Ç –º–æ–∂–µ –≤–∏–∫–æ–Ω–∞—Ç–∏ —Ü–µ –∑–∞–≤–¥–∞–Ω–Ω—è.</p>

<p>—Ç–∞–∫–æ–∂ –≤—ñ–¥–æ–º–æ —è–∫. –∑–∞–≤–¥–∞–Ω–Ω—è –≤–≤–∞–∂–∞—é—Ç—å—Å—è —ñ —ñ–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–∏–º–∏, —ñ –±–µ–∑—Å—Ç–∞–Ω–æ–≤–∏–º–∏.</p>

<p>–æ—Å—å –ø—Ä–∏–∫–ª–∞–¥ –∑–∞–≤–¥–∞–Ω–Ω—è, —â–æ –≤–∏–∫–æ–Ω—É—î –≥–µ–æ–ª–æ–∫–∞—Ü—ñ–π–Ω–∏–π –ø–æ—à—É–∫ —É –±—Ä–∞—É–∑–µ—Ä—ñ –∫–ª—ñ—î–Ω—Ç–∞ —Ç–∞ –≤—ñ–¥–ø—Ä–∞–≤–ª—è—î –π–æ–≥–æ –Ω–∞–∑–∞–¥ –Ω–∞ —Å–µ—Ä–≤–µ—Ä</p>

<div class="language-erb highlighter-rouge"><code class='code' style='white-space:pre;'><div class='code-line code-line-1'>
</div><div class='code-line code-line-2'>// –≤–∏–∫–æ–Ω—É—î –≥–µ–æ–ª–æ–∫–∞—Ü—ñ–π–Ω–∏–π –ø–æ—à—É–∫ –Ω–∞ google maps api —Ç–∞ –≤—ñ–¥–ø—Ä–∞–≤–ª—è—î –π–æ–≥–æ –Ω–∞–∑–∞–¥ –Ω–∞ —Å–µ—Ä–≤–µ—Ä
</div><div class='code-line code-line-3'>//
</div><div class='code-line code-line-4'>
</div><div class='code-line code-line-5'>&nbsp;&nbsp;<span style="color: #6e7781">&lt;%</span>
</div><div class='code-line code-line-6'>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #24292f;background-color: #f6f8fa">address</span>&nbsp;<span style="color: #0550ae">=</span>&nbsp;<span style="color: #24292f;background-color: #f6f8fa">location</span><span style="color: #24292f;background-color: #f6f8fa">.</span><span style="color: #8250df">raw_address</span>
</div><div class='code-line code-line-7'>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #24292f;background-color: #f6f8fa">url</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #0550ae">=</span>&nbsp;<span style="color: #953800">GGeocode</span><span style="color: #24292f;background-color: #f6f8fa">.</span><span style="color: #8250df">geocode_url_for</span><span style="color: #24292f;background-color: #f6f8fa">(</span><span style="color: #0a3069">:address</span>&nbsp;<span style="color: #0550ae">=&gt;</span>&nbsp;<span style="color: #24292f;background-color: #f6f8fa">address</span><span style="color: #24292f;background-color: #f6f8fa">).</span><span style="color: #8250df">to_s</span>
</div><div class='code-line code-line-8'>&nbsp;&nbsp;<span style="color: #6e7781">%&gt;</span>
</div><div class='code-line code-line-9'>
</div><div class='code-line code-line-10'>&nbsp;&nbsp;var&nbsp;address&nbsp;=&nbsp;<span style="color: #6e7781">&lt;%=</span>&nbsp;<span style="color: #24292f;background-color: #f6f8fa">raw</span>&nbsp;<span style="color: #24292f;background-color: #f6f8fa">address</span><span style="color: #24292f;background-color: #f6f8fa">.</span><span style="color: #8250df">to_json</span>&nbsp;<span style="color: #6e7781">%&gt;</span>;
</div><div class='code-line code-line-11'>&nbsp;&nbsp;var&nbsp;url&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;<span style="color: #6e7781">&lt;%=</span>&nbsp;<span style="color: #24292f;background-color: #f6f8fa">raw</span>&nbsp;<span style="color: #24292f;background-color: #f6f8fa">url</span><span style="color: #24292f;background-color: #f6f8fa">.</span><span style="color: #8250df">to_json</span>&nbsp;<span style="color: #6e7781">%&gt;</span>;
</div><div class='code-line code-line-12'>
</div><div class='code-line code-line-13'>&nbsp;&nbsp;var&nbsp;result;
</div><div class='code-line code-line-14'>
</div><div class='code-line code-line-15'>&nbsp;&nbsp;jQuery.ajax({
</div><div class='code-line code-line-16'>&nbsp;&nbsp;&nbsp;&nbsp;'type'&nbsp;&nbsp;:&nbsp;'GET',
</div><div class='code-line code-line-17'>&nbsp;&nbsp;&nbsp;&nbsp;'url'&nbsp;&nbsp;&nbsp;:&nbsp;url,
</div><div class='code-line code-line-18'>&nbsp;&nbsp;&nbsp;&nbsp;'cache'&nbsp;:&nbsp;false,
</div><div class='code-line code-line-19'>&nbsp;&nbsp;&nbsp;&nbsp;'async'&nbsp;:&nbsp;false,
</div><div class='code-line code-line-20'>
</div><div class='code-line code-line-21'>&nbsp;&nbsp;&nbsp;&nbsp;'success'&nbsp;:&nbsp;function(data){
</div><div class='code-line code-line-22'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result&nbsp;=&nbsp;data;
</div><div class='code-line code-line-23'>
</div><div class='code-line code-line-24'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;jQuery.ajax({
</div><div class='code-line code-line-25'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'type'&nbsp;&nbsp;:&nbsp;'POST',
</div><div class='code-line code-line-26'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'url'&nbsp;&nbsp;&nbsp;:&nbsp;'/api/geo_locations',
</div><div class='code-line code-line-27'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'cache'&nbsp;:&nbsp;false,
</div><div class='code-line code-line-28'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'async'&nbsp;:&nbsp;false,
</div><div class='code-line code-line-29'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'data'&nbsp;&nbsp;:&nbsp;{'address'&nbsp;:&nbsp;address,&nbsp;'data'&nbsp;:&nbsp;data}
</div><div class='code-line code-line-30'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;})
</div><div class='code-line code-line-31'>&nbsp;&nbsp;&nbsp;&nbsp;}
</div><div class='code-line code-line-32'>&nbsp;&nbsp;});
</div><div class='code-line code-line-33'>
</div><div class='code-line code-line-34'>&nbsp;&nbsp;result;
</div><div class='code-line code-line-35'>
</div><div class='code-line code-line-36'>
</div></code></div>

<p>–≥–µ–Ω–µ—Ä—É–≤–∞–Ω–Ω—è —Ü–∏—Ö –∑–∞–≤–¥–∞–Ω—å –∑ —Å–µ—Ä–≤–µ—Ä–∞ –ø—Ä–æ—Å—Ç–µ</p>

<div class="language-ruby highlighter-rouge"><code class='code' style='white-space:pre;'><div class='code-line code-line-1'>
</div><div class='code-line code-line-2'>&nbsp;&nbsp;<span style="color: #6e7781"># –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ —á—É–¥–æ–≤–∏–π gem rails_view</span>
</div><div class='code-line code-line-3'>
</div><div class='code-line code-line-4'>&nbsp;&nbsp;<span style="color: #24292f;background-color: #f6f8fa">code</span>&nbsp;<span style="color: #0550ae">=</span>&nbsp;<span style="color: #953800">View</span><span style="color: #24292f;background-color: #f6f8fa">.</span><span style="color: #8250df">render</span><span style="color: #24292f;background-color: #f6f8fa">(</span><span style="color: #0a3069">'javascript_jobs/job/geo_location.js.erb'</span><span style="color: #24292f;background-color: #f6f8fa">,</span>&nbsp;<span style="color: #0a3069">:locals</span>&nbsp;<span style="color: #0550ae">=&gt;</span>&nbsp;<span style="color: #24292f;background-color: #f6f8fa">{</span><span style="color: #0a3069">:location</span>&nbsp;<span style="color: #0550ae">=&gt;</span>&nbsp;<span style="color: #24292f;background-color: #f6f8fa">location</span><span style="color: #24292f;background-color: #f6f8fa">})</span>
</div><div class='code-line code-line-5'>
</div><div class='code-line code-line-6'>&nbsp;&nbsp;<span style="color: #953800">JavascriptJob</span><span style="color: #24292f;background-color: #f6f8fa">.</span><span style="color: #8250df">create</span>&nbsp;<span style="color: #0a3069">:code</span>&nbsp;<span style="color: #0550ae">=&gt;</span>&nbsp;<span style="color: #24292f;background-color: #f6f8fa">code</span>
</div><div class='code-line code-line-7'>
</div><div class='code-line code-line-8'>
</div></code></div>

<p>—Ç–µ–ø–µ—Ä –∑–∞–≤–¥–∞–Ω–Ω—è –∑–Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –≤ —á–µ—Ä–∑—ñ, —ñ —è–∫–∏–π—Å—å –∫–ª—ñ—î–Ω—Ç –≤—Ä–µ—à—Ç—ñ-—Ä–µ—à—Ç –≤–∏–∫–æ–Ω–∞—î —Ä–æ–±–æ—Ç—É<br />
–Ω–∞ –Ω–∞—à—É –∫–æ—Ä–∏—Å—Ç—å.</p>

<h2 id="the-result">—Ä–µ–∑—É–ª—å—Ç–∞—Ç</h2>

<p>–º–µ–Ω—ñ –≤–¥–∞–ª–æ—Å—è —É–Ω–∏–∫–Ω—É—Ç–∏ –ª—ñ—Ü–µ–Ω–∑—ñ–π–Ω–æ–≥–æ –∑–±–æ—Ä—É –≤ —Ä–æ–∑–º—ñ—Ä—ñ 10 000 –¥–æ–ª–∞—Ä—ñ–≤ —ñ –≤–∏–∫–æ–Ω–∞—Ç–∏ –±–∞–≥–∞—Ç–æ –∑–∞–ø–∏—Ç—ñ–≤ –¥–æ API –¥–ª—è –Ω–∞—Å–∏—á–µ–Ω–Ω—è –º–æ—ó—Ö –¥–∞–Ω–∏—Ö –∑–∞ –Ω–µ–≤–µ–ª–∏–∫—É —Ü—ñ–Ω—É –≤ —Å–∫–ª–∞–¥–Ω–æ—Å—Ç—ñ —Ç–∞ —Å–ø–ª–∞—á—É—é—á–∏ —Ü—ñ–Ω—É –µ–≤–µ–Ω—Ç—É–∞–ª—å–Ω–æ—ó –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ü—ñ—ó –∑–∞–∑–¥–∞–ª–µ–≥—ñ–¥—å.</p>

<h2 id="updates">–æ–Ω–æ–≤–ª–µ–Ω–Ω—è</h2>

<p>–Ω–∞ –±–æ–∫—Å—ñ, –æ–±–º–µ–∂–µ–Ω–æ–º—É 2500 –∑–∞–ø–∏—Ç–∞–º–∏/–¥–µ–Ω—å, –æ—Å—å —â–æ –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è –∑–∞ <em>1</em> –¥–µ–Ω—å</p>

<p><img src='/ro/dojo4/defeating-the-sticky-wicket-of-api-limits-with-a-javascript-worker-army/assets/screen-shot-2013-11-13-at-8.12.05_PM.png' /></p>

</div>
    </main>

    <footer>
      <hr>
<a href="/goto" name="goto">&mdash;&gt; goto</a>
<blockquote>
<ul>
  <li>
    <a href="mailto:i-hate-this@drawohara.io?subject=/defeating-the-sticky-wicket-of-api-limits-with-a-javascript-worker-army">üò©, i üñ§ ^this!<a>
  </li>
  <li>
    <a href="/now">/now<a>
  </li>
  <li>
    <a href="/about">/about<a>
  </li>
  <li>
    <a href="/contact">/contact<a>
  </li>
</ul>
</blockquote>
<a href="/">&lt;&mdash; eject</a>
    </footer>
  </body>
</html>