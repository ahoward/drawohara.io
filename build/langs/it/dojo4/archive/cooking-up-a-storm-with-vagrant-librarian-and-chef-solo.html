<html color-mode="user" lang="it">
  <head>
    <base href='/it' />
    <!-- ga -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-DQVD9T27V4"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-DQVD9T27V4');
    </script>

    <!-- deps -->
    <script type="module" src="/assets/js/turbo.es2017-esm.js" defer></script>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.fluid.classless.fuchsia.min.css"
    >

    <!-- defaults -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="color-scheme" content="light dark" />

    <!-- favicon -->
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">

    <!-- meta -->
    <title>Come Configurare Apache con Vagrant, Librarian e Chef-Solo</title>
    <meta property="og:title" content="Come Configurare Apache con Vagrant, Librarian e Chef-Solo"/>
    <meta property="og:description" content="vai avanti." />
    <meta property="og:image" content="https://drawohara.io/media/mick.jpg" />
    <meta property="og:image:type" content="image/jpeg" />
    <meta property="site:route" content=""/dojo4/archive/:id"">
    <meta property="site:params" content="{"ext":null,"id":"cooking-up-a-storm-with-vagrant-librarian-and-chef-solo"}">
    <meta property="site:path_info" content=""/cooking-up-a-storm-with-vagrant-librarian-and-chef-solo"">

    <style>
      /* anti pico */
      a {text-decoration: none !important; }
      /* anti turbo */
      html { transition: none !important; }
      .turbo-progress-bar { visibility: hidden; }
      /* anti progressive */
      html { margin: 1em; }
      img { display: block; text-align: center; }
    </style>

    <script>
      document.addEventListener("turbo:load", function() {
        const progressBar = document.querySelector('.turbo-progress-bar');
        if (progressBar) {
          progressBar.remove();
        }
      });
    </script>
  </head>
  <body>
    <header>
      <a href="/home">@drawohara</a>
      <hr>
    </header>
    <main>
      <div class="ro markdown">
        <p>È abbastanza facile configurare Apache su un singolo sistema. Diventa un po' più interessante se si hanno più vhost nella configurazione. Diventa ancora più divertente quando si ha una configurazione complessa che include il proxy, il reindirizzamento URL e alcune sostituzioni di testo.</p>
        <p>Ma comunque, nulla che un amministratore di sistema esperto non possa gestire con un po' di attenzione.</p>
        <p>Fino a quando, beh, devi farlo di nuovo.</p>
        <p>È qui che entrano in gioco strumenti come <a href="http://www.opscode.com">Chef</a> e <a href="http://puppetlabs.com">Puppet</a>. Entrambi gli strumenti consentono di dichiarare e definire l'aspetto dei sistemi e come devono essere configurati. Entrambi sono potenti e vengono utilizzati attivamente per configurare qualsiasi cosa, dalle <a href="https://github.com/boxen/boxen">postazioni di lavoro</a> <a href="https://github.com/atmos/cinderella">dei sviluppatori</a> a <a href="http://www.opscode.com/press-releases/facebook-likes-opscode-and-private-chef/">grandi distribuzioni di centinaia di migliaia di macchine</a>.</p>
        <p>Proprio come il software, è ancora necessario costruire e testare la configurazione che si sta creando. Le tue opzioni per farlo variano dal molto costoso (acquistare uno o più server), al moderatamente costoso (eseguire alcune istanze su EC2) al molto, molto economico. L'opzione molto, molto economica sarebbe quella di costruire e testare le tue ricette su macchine virtuali in esecuzione sul tuo sistema. È qui che entra in gioco <a href="http://www.vagrantup.com/">Vagrant</a>.</p>
        <p>Vagrant è un wrapper intorno alla piattaforma di virtualizzazione desktop <a href="https://www.virtualbox.org/">VirtualBox</a> di Oracle. La configurazione di Vagrant ruota intorno ad alcuni semplici concetti. Hai un file di configurazione denominato <code>Vagrantfile</code> alla radice del progetto. Quel file contiene alcune configurazioni di base come la base box da utilizzare per il progetto e quali porte esporre al sistema host. E altrettanto importante, può descrivere come provisionare la macchina virtuale in modo che soddisfi le esigenze del tuo progetto. Anche se Vagrant supporta sia Puppet che Chef, ho scelto di utilizzare Chef-Solo per provisionare questo progetto.</p>
        <p>Iniziare con Vagrant è semplice. Il primo passaggio è semplicemente installare la gemma <code>vagrant</code>. Proprio come qualsiasi altro progetto Ruby, ho scelto di installare <code>vagrant</code> e alcune altre gemme tramite Bundler. Ecco il <code>Gemfile</code> risultante:</p>
        <div class="language-ruby highlighter-rouge"><code class='code' style='white-space:pre;'><div class='code-line code-line-1'><span style="color: #24292f;background-color: #f6f8fa">source</span>&nbsp;<span style="color: #0a3069">'https://rubygems.org'</span>
</div><div class='code-line code-line-2'>
</div><div class='code-line code-line-3'><span style="color: #24292f;background-color: #f6f8fa">gem</span>&nbsp;<span style="color: #0a3069">'vagrant'</span>
</div><div class='code-line code-line-4'><span style="color: #24292f;background-color: #f6f8fa">gem</span>&nbsp;<span style="color: #0a3069">'librarian'</span>
</div></code></div>
        <p>L'esecuzione di <code>bundle install</code> ha installato le gemme necessarie nella directory del progetto. Un rapido <code>rbenv rehash</code> ha reso disponibile l'eseguibile vagrant per la mia shell.</p>
        <p>Il passaggio successivo è stato impostare la configurazione di base di Vagrant più semplice. Ho eseguito <code>vagrant init</code> e poi ho modificato il Vagrantfile risultante per farlo apparire così:</p>
        <div class="language-ruby highlighter-rouge"><code class='code' style='white-space:pre;'><div class='code-line code-line-1'><span style="color: #953800">Vagrant</span><span style="color: #0550ae">::</span><span style="color: #953800">Config</span><span style="color: #24292f;background-color: #f6f8fa">.</span><span style="color: #8250df">run</span>&nbsp;<span style="color: #cf222e">do</span>&nbsp;<span style="color: #0550ae">|</span><span style="color: #24292f;background-color: #f6f8fa">config</span><span style="color: #0550ae">|</span>
</div><div class='code-line code-line-2'>&nbsp;&nbsp;<span style="color: #6e7781"># Ogni ambiente virtuale Vagrant richiede una box da cui costruire.</span>
</div><div class='code-line code-line-3'>&nbsp;&nbsp;<span style="color: #24292f;background-color: #f6f8fa">config</span><span style="color: #24292f;background-color: #f6f8fa">.</span><span style="color: #8250df">vm</span><span style="color: #24292f;background-color: #f6f8fa">.</span><span style="color: #8250df">box</span>&nbsp;<span style="color: #0550ae">=</span>&nbsp;<span style="color: #0a3069">"ubuntu-precise-64"</span>
</div><div class='code-line code-line-4'>&nbsp;&nbsp;
</div><div class='code-line code-line-5'>&nbsp;&nbsp;<span style="color: #6e7781"># L'url da cui verrà recuperata la box 'config.vm.box' se</span>
</div><div class='code-line code-line-6'>&nbsp;&nbsp;<span style="color: #6e7781"># non esiste già sul sistema dell'utente.</span>
</div><div class='code-line code-line-7'>&nbsp;&nbsp;<span style="color: #24292f;background-color: #f6f8fa">config</span><span style="color: #24292f;background-color: #f6f8fa">.</span><span style="color: #8250df">vm</span><span style="color: #24292f;background-color: #f6f8fa">.</span><span style="color: #8250df">box_url</span>&nbsp;<span style="color: #0550ae">=</span>&nbsp;<span style="color: #0a3069">"http://files.vagrantup.com/precise64.box"</span>
</div><div class='code-line code-line-8'><span style="color: #cf222e">end</span>
</div></code></div>
        <p>Questo raggiunge 2 cose. Innanzitutto, dichiara il nome della box che stiamo costruendo e dove trovarla. Un rapido <code>vagrant up</code> scaricherà inizialmente la box di base, la importerà nel progetto e avvierà la VM. Ci vuole un po' di tempo per scaricare la box, ma viene memorizzata nella cache sul tuo sistema in modo da non doverla scaricare di nuovo. Puoi anche riutilizzare la stessa box di base se scegli di farlo in altri progetti. Chiamare <code>vagrant halt</code> ferma la VM e chiamare <code>vagrant destroy</code>, beh, distrugge la VM stessa.</p>
        <p>Non abbiamo ancora fatto molto per provisionare la nostra VM, comunque. Il passaggio successivo è dire a Vagrant come fare.</p>
        <p><a href="https://github.com/applicationsonline/librarian">Librarian</a> è un'altra gemma simpatica sul modello di Bundler e CocoaPods che consente di dichiarare quali ricette Chef stai utilizzando. Nel nostro caso, una copia ridotta del <code>Cheffile</code> del progetto appare così:</p>
        <div class="language-ruby highlighter-rouge"><code class='code' style='white-space:pre;'><div class='code-line code-line-1'><span style="color: #6e7781">#!/usr/bin/env ruby</span>
</div><div class='code-line code-line-2'><span style="color: #6e7781">#^syntax detection</span>
</div><div class='code-line code-line-3'>
</div><div class='code-line code-line-4'><span style="color: #24292f;background-color: #f6f8fa">site</span>&nbsp;<span style="color: #0a3069">'http://community.opscode.com/api/v1'</span>
</div><div class='code-line code-line-5'>
</div><div class='code-line code-line-6'><span style="color: #24292f;background-color: #f6f8fa">cookbook</span>&nbsp;<span style="color: #0a3069">'apt'</span>
</div><div class='code-line code-line-7'><span style="color: #24292f;background-color: #f6f8fa">cookbook</span>&nbsp;<span style="color: #0a3069">'apache2'</span><span style="color: #24292f;background-color: #f6f8fa">,</span>&nbsp;<span style="color: #0a3069">'&gt;= 1.0.0'</span>
</div><div class='code-line code-line-8'><span style="color: #24292f;background-color: #f6f8fa">cookbook</span>&nbsp;<span style="color: #0a3069">'rbenv'</span><span style="color: #24292f;background-color: #f6f8fa">,</span>&nbsp;<span style="color: #0a3069">:git</span>&nbsp;<span style="color: #0550ae">=&gt;</span>&nbsp;<span style="color: #0a3069">'git://github.com/fnichol/chef-rbenv.git'</span><span style="color: #24292f;background-color: #f6f8fa">,</span>&nbsp;<span style="color: #0a3069">:ref</span>&nbsp;<span style="color: #0550ae">=&gt;</span>&nbsp;<span style="color: #0a3069">'v0.7.2'</span>
</div><div class='code-line code-line-9'><span style="color: #24292f;background-color: #f6f8fa">cookbook</span>&nbsp;<span style="color: #0a3069">'ruby_build'</span>
</div><div class='code-line code-line-10'><span style="color: #24292f;background-color: #f6f8fa">cookbook</span>&nbsp;<span style="color: #0a3069">'openssh'</span><span style="color: #24292f;background-color: #f6f8fa">,</span>&nbsp;<span style="color: #0a3069">:git</span>&nbsp;<span style="color: #0550ae">=&gt;</span>&nbsp;<span style="color: #0a3069">'git://github.com/fnichol/chef-openssh.git'</span>
</div><div class='code-line code-line-11'><span style="color: #24292f;background-color: #f6f8fa">cookbook</span>&nbsp;<span style="color: #0a3069">'git'</span>
</div><div class='code-line code-line-12'><span style="color: #24292f;background-color: #f6f8fa">cookbook</span>&nbsp;<span style="color: #0a3069">'build-essential'</span>
</div><div class='code-line code-line-13'><span style="color: #24292f;background-color: #f6f8fa">cookbook</span>&nbsp;<span style="color: #0a3069">'vim'</span>
</div><div class='code-line code-line-14'><span style="color: #24292f;background-color: #f6f8fa">cookbook</span>&nbsp;<span style="color: #0a3069">'user'</span>
</div><div class='code-line code-line-15'><span style="color: #24292f;background-color: #f6f8fa">cookbook</span>&nbsp;<span style="color: #0a3069">'sudo'</span>
</div></code></div>
        <p>Il maggior beneficio è che non è necessario fornire i cookbook nei tuoi progetti. L'esecuzione di <code>librarian-chef install</code> scaricherà i cookbook e li installerà nella directory <code>cookbooks</code>. Questo ha anche generato un <code>Cheffile.lock</code> per documentare quale versione dei cookbook è stata installata.</p>
        <p>Ero a un punto in cui potevo dire a Vagrant di utilizzare Chef-Solo per provisionare la box aggiornando il <code>Vagrantfile</code>:</p>
        <div class="language-ruby highlighter-rouge"><code class='code' style='white-space:pre;'><div class='code-line code-line-1'><span style="color: #953800">Vagrant</span><span style="color: #0550ae">::</span><span style="color: #953800">Config</span><span style="color: #24292f;background-color: #f6f8fa">.</span><span style="color: #8250df">run</span>&nbsp;<span style="color: #cf222e">do</span>&nbsp;<span style="color: #0550ae">|</span><span style="color: #24292f;background-color: #f6f8fa">config</span><span style="color: #0550ae">|</span>
</div><div class='code-line code-line-2'>&nbsp;&nbsp;<span style="color: #6e7781"># Ogni ambiente virtuale Vagrant richiede una box da cui costruire.</span>
</div><div class='code-line code-line-3'>&nbsp;&nbsp;<span style="color: #24292f;background-color: #f6f8fa">config</span><span style="color: #24292f;background-color: #f6f8fa">.</span><span style="color: #8250df">vm</span><span style="color: #24292f;background-color: #f6f8fa">.</span><span style="color: #8250df">box</span>&nbsp;<span style="color: #0550ae">=</span>&nbsp;<span style="color: #0a3069">"ubuntu-precise-64"</span>
</div><div class='code-line code-line-4'>&nbsp;&nbsp;
</div><div class='code-line code-line-5'>&nbsp;&nbsp;<span style="color: #6e7781"># L'url da cui verrà recuperata la box 'config.vm.box' se</span>
</div><div class='code-line code-line-6'>&nbsp;&nbsp;<span style="color: #6e7781"># non esiste già sul sistema dell'utente.</span>
</div><div class='code-line code-line-7'>&nbsp;&nbsp;<span style="color: #24292f;background-color: #f6f8fa">config</span><span style="color: #24292f;background-color: #f6f8fa">.</span><span style="color: #8250df">vm</span><span style="color: #24292f;background-color: #f6f8fa">.</span><span style="color: #8250df">box_url</span>&nbsp;<span style="color: #0550ae">=</span>&nbsp;<span style="color: #0a3069">"http://files.vagrantup.com/precise64.box"</span>
</div><div class='code-line code-line-8'>&nbsp;&nbsp;
</div><div class='code-line code-line-9'>&nbsp;&nbsp;<span style="color: #6e7781"># Abilita il provisioning con chef solo, specificando un percorso dei cookbook, un percorso dei ruoli</span>
</div><div class='code-line code-line-10'>&nbsp;&nbsp;<span style="color: #6e7781"># e un percorso dei data_bags (tutti relativi a questo Vagrantfile), e aggiungendo</span>
</div><div class='code-line code-line-11'>&nbsp;&nbsp;<span style="color: #6e7781"># alcune ricette e/o ruoli.</span>
</div><div class='code-line code-line-12'>&nbsp;&nbsp;<span style="color: #24292f;background-color: #f6f8fa">config</span><span style="color: #24292f;background-color: #f6f8fa">.</span><span style="color: #8250df">vm</span><span style="color: #24292f;background-color: #f6f8fa">.</span><span style="color: #8250df">provision</span>&nbsp;<span style="color: #0a3069">:chef_solo</span>&nbsp;<span style="color: #cf222e">do</span>&nbsp;<span style="color: #0550ae">|</span><span style="color: #24292f;background-color: #f6f8fa">chef</span><span style="color: #0550ae">|</span>
</div><div class='code-line code-line-13'>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #24292f;background-color: #f6f8fa">chef</span><span style="color: #24292f;background-color: #f6f8fa">.</span><span style="color: #8250df">cookbooks_path</span>&nbsp;<span style="color: #0550ae">=</span>&nbsp;<span style="color: #24292f;background-color: #f6f8fa">[</span><span style="color: #0a3069">"cookbooks"</span><span style="color: #24292f;background-color: #f6f8fa">,</span>&nbsp;<span style="color: #0a3069">"site-cookbooks"</span><span style="color: #24292f;background-color: #f6f8fa">]</span>
</div><div class='code-line code-line-14'>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #24292f;background-color: #f6f8fa">chef</span><span style="color: #24292f;background-color: #f6f8fa">.</span><span style="color: #8250df">add_recipe</span>&nbsp;<span style="color: #0a3069">"apt"</span>
</div><div class='code-line code-line-15'>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #24292f;background-color: #f6f8fa">chef</span><span style="color: #24292f;background-color: #f6f8fa">.</span><span style="color: #8250df">add_recipe</span>&nbsp;<span style="color: #0a3069">"build-essential"</span>
</div><div class='code-line code-line-16'>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #24292f;background-color: #f6f8fa">chef</span><span style="color: #24292f;background-color: #f6f8fa">.</span><span style="color: #8250df">add_recipe</span>&nbsp;<span style="color: #0a3069">"ruby_build"</span>
</div><div class='code-line code-line-17'>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #24292f;background-color: #f6f8fa">chef</span><span style="color: #24292f;background-color: #f6f8fa">.</span><span style="color: #8250df">add_recipe</span>&nbsp;<span style="color: #0a3069">"rbenv::system"</span>
</div><div class='code-line code-line-18'>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #24292f;background-color: #f6f8fa">chef</span><span style="color: #24292f;background-color: #f6f8fa">.</span><span style="color: #8250df">add_recipe</span>&nbsp;<span style="color: #0a3069">"rbenv::vagrant"</span>
</div><div class='code-line code-line-19'>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #24292f;background-color: #f6f8fa">chef</span><span style="color: #24292f;background-color: #f6f8fa">.</span><span style="color: #8250df">add_recipe</span>&nbsp;<span style="color: #0a3069">"git"</span>
</div><div class='code-line code-line-20'>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #24292f;background-color: #f6f8fa">chef</span><span style="color: #24292f;background-color: #f6f8fa">.</span><span style="color: #8250df">add_recipe</span>&nbsp;<span style="color: #0a3069">"user"</span>
</div><div class='code-line code-line-21'>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #24292f;background-color: #f6f8fa">chef</span><span style="color: #24292f;background-color: #f6f8fa">.</span><span style="color: #8250df">add_recipe</span>&nbsp;<span style="color: #0a3069">"vim"</span>
</div><div class='code-line code-line-22'>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #24292f;background-color: #f6f8fa">chef</span><span style="color: #24292f;background-color: #f6f8fa">.</span><span style="color: #8250df">add_recipe</span>&nbsp;<span style="color: #0a3069">"sudo"</span>
</div><div class='code-line code-line-23'>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #24292f;background-color: #f6f8fa">chef</span><span style="color: #24292f;background-color: #f6f8fa">.</span><span style="color: #8250df">add_recipe</span>&nbsp;<span style="color: #0a3069">"openssh"</span>
</div><div class='code-line code-line-24'>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #24292f;background-color: #f6f8fa">chef</span><span style="color: #24292f;background-color: #f6f8fa">.</span><span style="color: #8250df">add_recipe</span>&nbsp;<span style="color: #0a3069">"apache2"</span>
</div><div class='code-line code-line-25'>&nbsp;&nbsp;&nbsp;&nbsp;
</div><div class='code-line code-line-26'>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #24292f;background-color: #f6f8fa">chef</span><span style="color: #24292f;background-color: #f6f8fa">.</span><span style="color: #8250df">json</span>&nbsp;<span style="color: #0550ae">=</span>&nbsp;<span style="color: #24292f;background-color: #f6f8fa">{</span>
</div><div class='code-line code-line-27'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #0a3069">authorization: </span><span style="color: #24292f;background-color: #f6f8fa">{</span>
</div><div class='code-line code-line-28'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #0a3069">sudo: </span><span style="color: #24292f;background-color: #f6f8fa">{</span>
</div><div class='code-line code-line-29'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #0a3069">passwordless: </span><span style="color: #cf222e">true</span><span style="color: #24292f;background-color: #f6f8fa">,</span>
</div><div class='code-line code-line-30'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #0a3069">groups: </span><span style="color: #24292f;background-color: #f6f8fa">[</span><span style="color: #0a3069">"admin"</span><span style="color: #24292f;background-color: #f6f8fa">,</span>&nbsp;<span style="color: #0a3069">"sudo"</span><span style="color: #24292f;background-color: #f6f8fa">]</span>
</div><div class='code-line code-line-31'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #24292f;background-color: #f6f8fa">}</span>
</div><div class='code-line code-line-32'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #24292f;background-color: #f6f8fa">},</span>
</div><div class='code-line code-line-33'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #0a3069">openssh: </span><span style="color: #24292f;background-color: #f6f8fa">{</span>
</div><div class='code-line code-line-34'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #0a3069">permit_root_login: </span><span style="color: #0a3069">"no"</span><span style="color: #24292f;background-color: #f6f8fa">,</span>
</div><div class='code-line code-line-35'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #0a3069">password_authentication: </span><span style="color: #0a3069">"yes"</span>
</div><div class='code-line code-line-36'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #24292f;background-color: #f6f8fa">},</span>
</div><div class='code-line code-line-37'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #0a3069">rbenv: </span><span style="color: #24292f;background-color: #f6f8fa">{</span>
</div><div class='code-line code-line-38'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #0a3069">rubies: </span><span style="color: #24292f;background-color: #f6f8fa">[</span>&nbsp;<span style="color: #0a3069">"1.9.3-p327"</span>&nbsp;<span style="color: #24292f;background-color: #f6f8fa">],</span>
</div><div class='code-line code-line-39'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #0a3069">upgrade: </span><span style="color: #cf222e">true</span><span style="color: #24292f;background-color: #f6f8fa">,</span>
</div><div class='code-line code-line-40'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #0a3069">global: </span><span style="color: #0a3069">"1.9.3-p327"</span><span style="color: #24292f;background-color: #f6f8fa">,</span>
</div><div class='code-line code-line-41'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #0a3069">gems: </span><span style="color: #24292f;background-color: #f6f8fa">{</span>
</div><div class='code-line code-line-42'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #0a3069">"1.9.3-p327"</span>&nbsp;<span style="color: #0550ae">=&gt;</span>&nbsp;<span style="color: #24292f;background-color: #f6f8fa">[</span>
</div><div class='code-line code-line-43'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #24292f;background-color: #f6f8fa">{</span>&nbsp;<span style="color: #0a3069">name: </span><span style="color: #0a3069">"bundler"</span>&nbsp;<span style="color: #24292f;background-color: #f6f8fa">},</span>
</div><div class='code-line code-line-44'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #24292f;background-color: #f6f8fa">{</span>&nbsp;<span style="color: #0a3069">name: </span><span style="color: #0a3069">"main"</span>&nbsp;<span style="color: #24292f;background-color: #f6f8fa">},</span>
</div><div class='code-line code-line-45'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #24292f;background-color: #f6f8fa">{</span>&nbsp;<span style="color: #0a3069">name: </span><span style="color: #0a3069">"map"</span>&nbsp;<span style="color: #24292f;background-color: #f6f8fa">},</span>
</div><div class='code-line code-line-46'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #24292f;background-color: #f6f8fa">{</span>&nbsp;<span style="color: #0a3069">name: </span><span style="color: #0a3069">"open4"</span>&nbsp;<span style="color: #24292f;background-color: #f6f8fa">},</span>
</div><div class='code-line code-line-47'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #24292f;background-color: #f6f8fa">{</span>&nbsp;<span style="color: #0a3069">name: </span><span style="color: #0a3069">"multi_json"</span>&nbsp;<span style="color: #24292f;background-color: #f6f8fa">},</span>
</div><div class='code-line code-line-48'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #24292f;background-color: #f6f8fa">{</span>&nbsp;<span style="color: #0a3069">name: </span><span style="color: #0a3069">"net-ssh"</span><span style="color: #24292f;background-color: #f6f8fa">,</span>&nbsp;<span style="color: #0a3069">version: </span><span style="color: #0a3069">"~&gt; 2.2.0"</span>&nbsp;<span style="color: #24292f;background-color: #f6f8fa">},</span>
</div><div class='code-line code-line-49'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #24292f;background-color: #f6f8fa">{</span>&nbsp;<span style="color: #0a3069">name: </span><span style="color: #0a3069">"aws-sdk"</span>&nbsp;<span style="color: #24292f;background-color: #f6f8fa">},</span>
</div><div class='code-line code-line-50'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #24292f;background-color: #f6f8fa">{</span>&nbsp;<span style="color: #0a3069">name: </span><span style="color: #0a3069">"chef"</span>&nbsp;<span style="color: #24292f;background-color: #f6f8fa">},</span>
</div><div class='code-line code-line-51'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #24292f;background-color: #f6f8fa">{</span>&nbsp;<span style="color: #0a3069">name: </span><span style="color: #0a3069">"ohai"</span>&nbsp;<span style="color: #24292f;background-color: #f6f8fa">}</span>
</div><div class='code-line code-line-52'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #24292f;background-color: #f6f8fa">]</span>
</div><div class='code-line code-line-53'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #24292f;background-color: #f6f8fa">}</span>
</div><div class='code-line code-line-54'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #24292f;background-color: #f6f8fa">},</span>
</div><div class='code-line code-line-55'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #0a3069">apache: </span><span style="color: #24292f;background-color: #f6f8fa">{</span>
</div><div class='code-line code-line-56'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #0a3069">default_site_enabled: </span><span style="color: #cf222e">false</span>
</div><div class='code-line code-line-57'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #24292f;background-color: #f6f8fa">}</span>
</div><div class='code-line code-line-58'>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #24292f;background-color: #f6f8fa">}</span>
</div><div class='code-line code-line-59'>&nbsp;&nbsp;<span style="color: #cf222e">end</span>
</div><div class='code-line code-line-60'><span style="color: #cf222e">end</span>
</div></code></div>
        <p>Ho rapidamente creato una directory <code>site-cookbooks</code> e ho iniziato a costruire le ricette necessarie per configurare e provisionare il software richiesto per questa parte del progetto. Sono stato in grado di applicare rapidamente la configurazione aggiornata utilizzando <code>vagrant provision</code> o <code>vagrant reload</code> (se avevo bisogno di un riavvio). Ho persino distrutto la VM su cui stavo lavorando e l'ho riprovisionata da zero per assicurarmi che tutto funzionasse.</p>
        <p>Il premio per questo sforzo è stato quello di utilizzare rapidamente le stesse ricette e configurazioni per configurare i server effettivi che supportano questo progetto. Ero sicuro del risultato avendo costruito e testato con successo localmente prima, proprio come il codice che scrivo. Da qui l'espressione: infrastruttura come codice.</p>
      </div>
    </main>
    <footer>
      <hr>
      <a href="/goto" name="goto">&mdash;&gt; goto</a>
      <blockquote>
        <ul>
          <li>
            <a href="/about">about</a>
          </li>
          <li>
            <a href="mailto:i-hate-this@drawohara.io?subject=/cooking-up-a-storm-with-vagrant-librarian-and-chef-solo">i-hate-this</a>
          </li>
          <li>
            <a href="mailto:i-love-this@drawohara.io?subject=/cooking-up-a-storm-with-vagrant-librarian-and-chef-solo">i-love-this</a>
          </li>
          <li>
            <a href="/contact">contact</a>
          </li>
        </ul>
      </blockquote>
      <a href="/">&lt;&mdash; eject</a>
    </footer>
  </body>
</html>