<html color-mode="user" lang="es">
  <head>
  <!-- ga -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-DQVD9T27V4"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-DQVD9T27V4');
</script>

  <!-- deps -->
    <script type="module" src="/assets/js/turbo.es2017-esm.js" defer></script>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.fluid.classless.fuchsia.min.css"
    >

  <!-- langs -->
  <!--
    https://developers.google.com/search/docs/specialty/international/localized-versions#html
  -->
   <link rel="alternate" hreflang="en" href="/" />
   <link rel="alternate" hreflang="uk" href="https://drawohara.io/langs/uk" />
   <link rel="alternate" hreflang="sv" href="https://drawohara.io/langs/sv" />
   <link rel="alternate" hreflang="fr" href="https://drawohara.io/langs/fr" />
   <link rel="alternate" hreflang="es" href="https://drawohara.io/langs/es" />
   <link rel="alternate" hreflang="it" href="https://drawohara.io/langs/it" />

  <!-- defaults -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="color-scheme" content="light dark" />
    <base href='/langs/es' />

  <!-- favicon -->
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">

  <!-- meta -->
    <title>no hay nada que ver aqu칤.</title>

<meta property="og:title" content="no hay nada que ver aqu칤."/>
<meta property="og:description" content="sigue adelante." />
<meta property="og:image" content="https://drawohara.io/media/mick.jpg" />




  <meta property="og:image:type" content="image/jpeg" />

    <meta property="site:route" content=""/dojo4/archive/:id"">
    <meta property="site:params" content="{"ext":null,"id":"aws-ebs-backups-we-rewrote-drebs"}">
    <meta property="site:path_info" content=""/aws-ebs-backups-we-rewrote-drebs"">

    <style>
      /* anti pico */
      a {text-decoration: none !important; }

      /* anti turbo */
      html { transition: none !important; }
      .turbo-progress-bar { visibility: hidden; }

      /* anti progressive */
      html { margin: 1em; }
      img { display: block; text-align: center; }
    </style>

    <script>
      document.addEventListener("turbo:load", function() {
        const progressBar = document.querySelector('.turbo-progress-bar');
        if (progressBar) { progressBar.remove(); }
      });
    </script>
  </head>

  <body>
    <header>
      <a href="/home">@drawohara</a> &mdash;
<a href="mailto:i-love-this@drawohara.io?subject=/aws-ebs-backups-we-rewrote-drebs">춰me 仇벒잺  encanta!</a>
<small>
  <small>
    <small>
      <span title='b칠belo'>&lt;&lt; haz clic en m칤 游냍 游삈 游빀</a>
    </small>
  </small>
</small>
<hr>
<strong>/aws-ebs-backups-we-rewrote-drebs</strong>
    </header>

    <main>
      <em>publicado el: 2014-06-23</em>
<br>
<br>
<div class="ro markdown">
  <p>El otro d칤a lanzamos la versi칩n 0.1.0 de <a href="https://rubygems.org/gems/drebs">DREBS</a>, nuestro script de Recuperaci칩n de Desastres para Almacenamiento en Bloques El치sticos. Lo usamos cada hora en nuestras 3 instancias de EC2, respaldando 6 diferentes vol칰menes de EBS. Este script es crucial para nosotros y para la comunidad de AWS en general porque Amazon no admite oficialmente ning칰n script o herramienta de este tipo para proporcionar copias de seguridad. Existen varios productos SaaS que ofrecen esta funcionalidad, pero los scripts de c칩digo abierto para hackers como nosotros son escasos. La nueva versi칩n reescrita est치 lista para producci칩n y esperamos que la disfrutes tanto como nosotros.</p>

<p>El a침o pasado, el ex empleado de dojo4 y amigo eterno del dojo <a href="https://twitter.com/shulmang">Garett Shulman</a>, lanz칩 la <a href="http://dojo4.com/blog/a-simple-backup-strategy-for-amazon-cloud-hosts">primera versi칩n de DREBS</a>. Ten칤a el simple objetivo de permitir a un administrador definir estrategias de respaldo y tareas pre/post respaldo (mysqldump, etc.) para cada volumen de EBS montado en una instancia de EC2. Una simple tarea cron ejecuta DREBS cada hora, que recorre cada estrategia de respaldo de la instancia de EBS y, si la estrategia indica que debe realizarse un respaldo, DREBS utiliza la gema <a href="https://github.com/rightscale/right_aws">right_aws</a> para respaldar el volumen y subirlo a la cuenta de AWS como una instant치nea de EBS.</p>

<p>La nueva versi칩n de DREBS proporciona la misma funcionalidad pero con algunas mejoras:</p>

<ul>
  <li>El estado ahora se almacena en una peque침a base de datos sqlite en lugar de un archivo json.</li>
  <li>Resistente cuando las estrategias cambian.</li>
  <li>Resistente cuando se eliminan instant치neas en la consola de AWS.</li>
  <li>Un shell de DREBS que te permite probar tu configuraci칩n f치cil y r치pidamente.</li>
</ul>

<p>Como ejemplo de configuraci칩n, aqu칤 est치 DREBS en nuestro crontab en todas nuestras m치quinas:</p>

<pre><code>0 * * * * /home/dojo4/git/drebs/bin/drebs execute /usr/local/var/drebs_config.yml &amp;&gt; /usr/local/var/drebs_cron.out
</code></pre>

<p>y aqu칤 est치 nuestro archivo de configuraci칩n para una de nuestras instancias de EC2:</p>

<pre><code>---
aws_access_key_id: XXXX
aws_secret_access_key: XXX
region: us-west-1
strategies:
- hours_between: 6
  num_to_keep: 12
  mount_point: /dev/sdh
  pre_snapshot_tasks:
  - pg_dump -U postgres -f /ebs/databases/postgresql/backups/project_name_production.sql project_name_production
  post_snapshot_tasks:
- hours_between: 1
  num_to_keep: 2
  mount_point: /dev/sda1
  pre_snapshot_tasks:
  post_snapshot_tasks:
- hours_between: 24
  num_to_keep: 4
  mount_point: /dev/sda1
- hours_between: 96
  num_to_keep: 4
  mount_point: /dev/sda1
log_path: /usr/local/var/drebs.log
email_on_exception: miles@dojo4.com
email_host: smtp.gmail.com
email_port: 587
email_domain: gmail.com
email_user: xxx
email_password: xxx
</code></pre>

<p>Como siempre, tenemos m치s ideas sobre c칩mo mejorar este script y, si este script te ayuda tanto como a nosotros, te invitamos a hacer un fork del <a href="https://github.com/dojo4/drebs">repositorio</a> y enviarnos una solicitud de extracci칩n:</p>

<ul>
  <li>Mejorar la cobertura de pruebas</li>
  <li>Usar la gema whenever para una configuraci칩n m치s f치cil de crontab</li>
  <li>Intervalos de ejecuci칩n arbitrarios (instant치neas cada 5 minutos en lugar de cada hora)</li>
  <li>Claves de API de AWS y otros valores de configuraci칩n desde AWS Instance Data</li>
  <li>Agregar configuraci칩n de acceso de ejemplo para usuario de AWS</li>
</ul>

<p>Creemos que DREBS es una gran contribuci칩n a la comunidad de AWS que nos ha ayudado a construir una excelente arquitectura de implementaci칩n que ha alojado sitios web y productos incre칤bles a lo largo de los a침os. Si est치s de acuerdo y lo usas, nos encantar칤a escuchar tu opini칩n en twitter en <a href="https://twitter.com/intent/tweet?text=@dojo4">@dojo4</a>!</p>

</div>
    </main>

    <footer>
      <hr>
<a href="/goto" name="goto">&mdash;&gt; ir a</a>
<blockquote>
<ul>
  <li>
    <a href="mailto:i-hate-this@drawohara.io?subject=/aws-ebs-backups-we-rewrote-drebs">游땰, i 游둯 ^esto!<a>
  </li>
  <li>
    <a href="/now">/ahora<a>
  </li>
  <li>
    <a href="/about">/acerca de<a>
  </li>
  <li>
    <a href="/contact">/contacto<a>
  </li>
</ul>
</blockquote>
<a href="/">&lt;&mdash; salir</a>
    </footer>
  </body>
</html>