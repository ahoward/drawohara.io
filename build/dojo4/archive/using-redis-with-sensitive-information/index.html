<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>drawohara</title>

  

  <!-- favicon -->
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">

  <style>
    /* reset */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    /* layout */
    body {
      max-width: 42rem;
      margin: 2rem auto;
      padding: 0 1rem;
      font: 16px/1.6 'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, Courier, monospace;
      color: #333;
      background: #fff;
    }

    /* typography */
    h1, h2, h3, h4, h5, h6 {
      margin: 1.5rem 0 0.5rem;
      line-height: 1.2;
    }

    h1 { font-size: 2rem; }
    h2 { font-size: 1.5rem; }
    h3 { font-size: 1.25rem; }

    p, blockquote, ul, ol {
      margin: 0.5rem 0;
    }

    li {
      margin-left: 2rem;
    }

    blockquote {
      margin-left: 1rem;
      padding-left: 1rem;
      border-left: 2px solid #ddd;
      font-style: italic;
    }

    /* links */
    a {
      color: #0066cc;
      text-decoration: none;
    }

    a:hover {
      text-decoration: underline;
    }

    a:visited {
      color: #551a8b;
    }

    /* code */
    code, pre {
      font-family: 'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, Courier, monospace;
      background: #f5f5f5;
    }

    code {
      padding: 0.1em 0.3em;
      font-size: 0.9em;
    }

    pre {
      padding: 1rem;
      overflow-x: auto;
      margin: 1rem 0;
    }

    pre code {
      padding: 0;
      background: none;
    }

    /* images */
    img {
      max-width: 100%;
      height: auto;
      display: block;
      margin: 1rem 0;
    }

    /* horizontal rule */
    hr {
      border: none;
      border-top: 1px solid #ddd;
      margin: 1rem 0;
    }

    /* header/footer */
    header {
      margin-bottom: 2rem;
    }

    footer {
      margin-top: 3rem;
      font-size: 0.9em;
      color: #666;
    }

    /* dark mode */
    @media (prefers-color-scheme: dark) {
      body {
        color: #ddd;
        background: #111;
      }

      a {
        color: #58a6ff;
      }

      a:visited {
        color: #a371f7;
      }

      code, pre {
        background: #222;
      }

      blockquote {
        border-left-color: #444;
      }

      hr {
        border-top-color: #333;
      }

      footer {
        color: #888;
      }
    }
  </style>
</head>

<body>
  <header>
    <a href="/">@drawohara</a>
<small>
  <a href="mailto:i-love-this@drawohara.io?subject=/using-redis-with-sensitive-information">‚ù§Ô∏è</a>
  ||
  <a href="mailto:this-makes-me-sad@drawohara.io?subject=/using-redis-with-sensitive-information">üíô</a>
</small>
<hr>
  </header>

  <main>
    <em>published on: 2014-04-14</em>
<br>
<br>
<div class="ro markdown">
  <p><strong>Update:</strong> Redis creator <a href="https://github.com/antirez">Salvatore Sanfilippo</a> responded to my pull request documenting this method of disabling <code>bgsave</code> with <a href="https://github.com/antirez/redis/pull/1683#issuecomment-41163718">this comment</a>. Since he agrees there should be a community design process around supporting the disabling of persistence in redis, I added a <a href="https://github.com/antirez/redis/issues/1704">new issue</a> to allow that discussion to happen. Looking forward to seeing the design process and being a part of it.</p>

<p><strong>Update:</strong> Initial work on officially supporting a ‚Äòdisable persistence‚Äô configuration has begun by <a href="https://twitter.com/mattsta">Matt Stancliff</a>. See Matt‚Äôs work <a href="https://github.com/antirez/redis/issues/1704#issuecomment-42575432">here</a>. This is awesome to see. Thanks Matt!</p>

<p>I spent hours researching and scheming on how to prevent <a href="redis.io">redis</a> from writing any database values to disk, since the redis instance will be handling sensitive information. (In our case we‚Äôre storing cvv‚Äôs for 60 minutes and due to PCI compliance regarding credit card usage, absolutely cannot write these values to disk - ever.)</p>

<p>Read the docs, the config file, googled, tested, and even tried telling it to write to <code>/dev/null</code>.</p>

<p>Finally the answer came from ‚ÄòTheRealBill_here‚Äô on the <code>#redis</code> irc channel:</p>

<pre><code>dbfilename ""
</code></pre>

<p>in the config file.</p>

<p>Here‚Äôs <a href="http://irclogger.com/.redis/2014-04-14#1397514047">a link to our whole conversation</a> if you‚Äôre interested.</p>

<p>I also submitted <a href="https://github.com/antirez/redis/pull/1683">a pull request</a> to add a note in the config file for redis.</p>

<p>This answer came to me after I had already made a couple of other decisions about configuring redis to store credit card information:</p>

<ul>
  <li><code>loglevel</code> has a default of info, which won‚Äôt print each read/write, so we‚Äôre good there. Although for our use case we would probably feel comfortable just disabling logging altogether.</li>
  <li><code>save</code> directive is set at <code>save ""</code> so that snapshotting is definitely disabled.</li>
  <li><code>replication</code> not in play. When using replication, the master initializes a slave by writing its own database contents to disk, sending the slave that file, and the slave loading the database dump into its database. Obviously, we can‚Äôt do that. (Also note that if we did add a slave at some point, it wouldn‚Äôt be able to sync with our current config of <code>dbfilename ""</code>. See the log for the error when you call <code>bgsave</code> from <code>redis-cli</code> yourself.)</li>
</ul>

</div>
  </main>

  <footer>
    <hr>
<small>[ <a href="/cv">cv</a> | <a href="/io">io</a> | <a href="/jess">jess</a> | <a href="/contact">contact</a> ]</small>
  </footer>
</body>
</html>