<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>drawohara</title>

  

  <!-- favicon -->
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">

  <style>
    /* reset */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    /* layout */
    body {
      max-width: 42rem;
      margin: 2rem auto;
      padding: 0 1rem;
      font: 16px/1.6 'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, Courier, monospace;
      color: #333;
      background: #fff;
    }

    /* typography */
    h1, h2, h3, h4, h5, h6 {
      margin: 1.5rem 0 0.5rem;
      line-height: 1.2;
    }

    h1 { font-size: 2rem; }
    h2 { font-size: 1.5rem; }
    h3 { font-size: 1.25rem; }

    p, blockquote, ul, ol {
      margin: 0.5rem 0;
    }

    li {
      margin-left: 2rem;
    }

    blockquote {
      margin-left: 1rem;
      padding-left: 1rem;
      border-left: 2px solid #ddd;
      font-style: italic;
    }

    /* links */
    a {
      color: #0066cc;
      text-decoration: none;
    }

    a:hover {
      text-decoration: underline;
    }

    a:visited {
      color: #551a8b;
    }

    /* code */
    code, pre {
      font-family: 'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, Courier, monospace;
      background: #f5f5f5;
    }

    code {
      padding: 0.1em 0.3em;
      font-size: 0.9em;
    }

    pre {
      padding: 1rem;
      overflow-x: auto;
      margin: 1rem 0;
    }

    pre code {
      padding: 0;
      background: none;
    }

    /* images */
    img {
      max-width: 100%;
      height: auto;
      display: block;
      margin: 1rem 0;
    }

    /* horizontal rule */
    hr {
      border: none;
      border-top: 1px solid #ddd;
      margin: 1rem 0;
    }

    /* header/footer */
    header {
      margin-bottom: 2rem;
    }

    footer {
      margin-top: 3rem;
      font-size: 0.9em;
      color: #666;
    }

    /* dark mode */
    @media (prefers-color-scheme: dark) {
      body {
        color: #ddd;
        background: #111;
      }

      a {
        color: #58a6ff;
      }

      a:visited {
        color: #a371f7;
      }

      code, pre {
        background: #222;
      }

      blockquote {
        border-left-color: #444;
      }

      hr {
        border-top-color: #333;
      }

      footer {
        color: #888;
      }
    }
  </style>
</head>

<body>
  <header>
    <a href="/">@drawohara</a>
<small>
  <a href="mailto:i-love-this@drawohara.io?subject=/aws-dns-https-doj4-hosting">‚ù§Ô∏è</a>
  ||
  <a href="mailto:this-makes-me-sad@drawohara.io?subject=/aws-dns-https-doj4-hosting">üíô</a>
</small>
<hr>
  </header>

  <main>
    <em>published on: 2014-04-07</em>
<br>
<br>
<div class="ro markdown">
  <p>Hosting, DNS &amp; HTTPS often require the interactions of more than a few providers.  Often becoming unwieldily if not managed effectively.</p>

<p>DNS requires both record management and domain registration.  For both Dojo4 has employed <a href="http://dyn.com/dns">DyDNS</a> for many years.</p>

<p>Dojo4 generally uses <a href="http://aws.amazon.com/ec2">Amazon AWS EC2 cloud computers</a> for hosting and as such tend to use <a href="http://aws.amazon.com/elasticloadbalancing">AWS ELB load balancers</a> in front of those web hosts.  Unfortunately, Amazon doesn‚Äôt give you a consistent IP addresses for ELB instances and so consequently the only way to create second level domain records pointing to ELB instances is to use <a href="http://aws.amazon.com/route53">Amazon AWS Route53</a> for record management which has a special alias record for the purpose.  So, we tend to use Route53 for DNS record management.</p>

<p>Due to the way TLS handshakes are negotiated by linux/apache you are limited to the number of SSL certificates that can be served to the number of IP‚Äôs on the host.  With EC2 this is basically a single cert if you are not using a <a href="http://aws.amazon.com/vpc">VPC</a>.  Dojo4 often uses ELB‚Äôs to provide SSL as a means to get around this.</p>

<p>DNS &amp; HTTPS are closely related as the domains and subdomains to be secured must be enumerated prior to certificate provisioning.  Often the most convenient and flexible strategy is to get a wildcard cert.  Note, though, that not all wildcard certificate issuers include the base domain in the certificate (so you can only use the cert to protect *.somedomain.com, and not somedomain.com).  The $100/year wildcard certificate from <a href="dnsimple.com">dnsimple.com</a> issued by <a href="http://comodo.com">Comodo</a> and including the base domain is a good value even with the $96 ($8/month * 12 months) dnsimple dns hosting cost.</p>

<p>dnsimple has some other convenient features such as being able to delegate management of records set to other dnsimple user accounts.  As we have moved record set management from DynDNS to Route53, and are having an account on dnsimple for SSL provisioning, we went ahead and moved domain registration from DynDNS to dnsimple to consolidate services.</p>

<p>Some handy command-liners:</p>

<p>Find the Start Of Authority for a DNS record</p>
<blockquote>
  <p>dig SOA dojo4.com</p>
</blockquote>

<p>View the certificate that a host is serving</p>
<blockquote>
  <p>openssl s_client -showcerts -connect dojo4.com:443 &lt; /dev/null</p>
</blockquote>

<p>Access a web server by IP ignoring SSL verification</p>
<blockquote>
  <p>curl -k <a href="https://184.72.61.241" target="_blank">https://184.72.61.241</a> -H ‚ÄúHost: projects.dojo4.com‚Äù</p>
</blockquote>

</div>
  </main>

  <footer>
    <hr>
<small>[ <a href="/cv">cv</a> | <a href="/io">io</a> | <a href="/jess">jess</a> | <a href="/contact">contact</a> ]</small>
  </footer>
</body>
</html>