{
  "data": {
    "dojo4/writing-hygienic-mixins-in-ruby": {
      "author": "ara@dojo4.com",
      "title": "Writing Hygienic Mixins In Ruby",
      "published_at": "2014-07-24 15:21:47 UTC",
      "body": "<div class=\"ro markdown\">\n  <div class=\"language-ruby highlighter-rouge\"><code class='code' style='white-space:pre;'><div class='code-line code-line-1'>\n</div><div class='code-line code-line-2'>\n</div><div class='code-line code-line-3'><span style=\"color: #6e7781\">=begin</span>\n</div><div class='code-line code-line-4'>\n</div><div class='code-line code-line-5'><span style=\"color: #6e7781\">  it's quite common, in ruby, for modules to provide functionality via mixins.</span>\n</div><div class='code-line code-line-6'>\n</div><div class='code-line code-line-7'>\n</div><div class='code-line code-line-8'><span style=\"color: #6e7781\">  for example:</span>\n</div><div class='code-line code-line-9'><span style=\"color: #6e7781\">  </span>\n</div><div class='code-line code-line-10'>\n</div><div class='code-line code-line-11'><span style=\"color: #6e7781\">=end</span>\n</div><div class='code-line code-line-12'>\n</div><div class='code-line code-line-13'>&nbsp;&nbsp;<span style=\"color: #cf222e\">module</span>&nbsp;<span style=\"color: #953800\">Mixin</span>\n</div><div class='code-line code-line-14'>&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: #cf222e\">def</span>&nbsp;<span style=\"color: #8250df\">foo</span>\n</div><div class='code-line code-line-15'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: #0550ae\">42</span>\n</div><div class='code-line code-line-16'>&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: #cf222e\">end</span>\n</div><div class='code-line code-line-17'>&nbsp;&nbsp;<span style=\"color: #cf222e\">end</span>\n</div><div class='code-line code-line-18'>\n</div><div class='code-line code-line-19'>&nbsp;&nbsp;<span style=\"color: #cf222e\">class</span>&nbsp;<span style=\"color: #953800\">C</span>\n</div><div class='code-line code-line-20'>&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: #cf222e\">include</span>&nbsp;<span style=\"color: #953800\">Mixin</span>\n</div><div class='code-line code-line-21'>&nbsp;&nbsp;<span style=\"color: #cf222e\">end</span>\n</div><div class='code-line code-line-22'>\n</div><div class='code-line code-line-23'>&nbsp;&nbsp;<span style=\"color: #953800\">p</span>&nbsp;<span style=\"color: #953800\">C</span><span style=\"color: #24292f;background-color: #f6f8fa\">.</span><span style=\"color: #8250df\">new</span><span style=\"color: #24292f;background-color: #f6f8fa\">.</span><span style=\"color: #8250df\">foo</span>&nbsp;<span style=\"color: #6e7781\">#=&gt; 42</span>\n</div><div class='code-line code-line-24'>\n</div><div class='code-line code-line-25'><span style=\"color: #6e7781\">=begin</span>\n</div><div class='code-line code-line-26'>\n</div><div class='code-line code-line-27'><span style=\"color: #6e7781\">  althouge handy, the guts of the mixin, especially modules, can easily leak</span>\n</div><div class='code-line code-line-28'><span style=\"color: #6e7781\">  into the target unintentially.</span>\n</div><div class='code-line code-line-29'><span style=\"color: #6e7781\">  </span>\n</div><div class='code-line code-line-30'><span style=\"color: #6e7781\">  here the 'Util' module gets zippered in-between the Mixin and C:</span>\n</div><div class='code-line code-line-31'>\n</div><div class='code-line code-line-32'>\n</div><div class='code-line code-line-33'><span style=\"color: #6e7781\">=end</span>\n</div><div class='code-line code-line-34'>\n</div><div class='code-line code-line-35'>&nbsp;&nbsp;<span style=\"color: #24292f;background-color: #f6f8fa\">reset!</span>\n</div><div class='code-line code-line-36'>\n</div><div class='code-line code-line-37'>&nbsp;&nbsp;<span style=\"color: #cf222e\">module</span>&nbsp;<span style=\"color: #953800\">Mixin</span>\n</div><div class='code-line code-line-38'>&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: #cf222e\">module</span>&nbsp;<span style=\"color: #953800\">Util</span>\n</div><div class='code-line code-line-39'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: #cf222e\">def</span>&nbsp;<span style=\"color: #953800\">Util</span><span style=\"color: #0550ae\">.</span><span style=\"color: #8250df\">foo</span>\n</div><div class='code-line code-line-40'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: #0550ae\">42</span>\n</div><div class='code-line code-line-41'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: #cf222e\">end</span>\n</div><div class='code-line code-line-42'>&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: #cf222e\">end</span>\n</div><div class='code-line code-line-43'>&nbsp;&nbsp;<span style=\"color: #cf222e\">end</span>\n</div><div class='code-line code-line-44'>\n</div><div class='code-line code-line-45'>&nbsp;&nbsp;<span style=\"color: #cf222e\">class</span>&nbsp;<span style=\"color: #953800\">C</span>\n</div><div class='code-line code-line-46'>&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: #cf222e\">include</span>&nbsp;<span style=\"color: #953800\">Mixin</span>\n</div><div class='code-line code-line-47'>\n</div><div class='code-line code-line-48'>&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: #953800\">p</span>&nbsp;<span style=\"color: #953800\">Util</span><span style=\"color: #24292f;background-color: #f6f8fa\">.</span><span style=\"color: #8250df\">foo</span>&nbsp;<span style=\"color: #6e7781\">#=&gt; 42</span>\n</div><div class='code-line code-line-49'>\n</div><div class='code-line code-line-50'>&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: #cf222e\">module</span>&nbsp;<span style=\"color: #953800\">Util</span>\n</div><div class='code-line code-line-51'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: #cf222e\">def</span>&nbsp;<span style=\"color: #953800\">Util</span><span style=\"color: #0550ae\">.</span><span style=\"color: #8250df\">bar</span>\n</div><div class='code-line code-line-52'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: #0550ae\">42.0</span>\n</div><div class='code-line code-line-53'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: #cf222e\">end</span>\n</div><div class='code-line code-line-54'>&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: #cf222e\">end</span>\n</div><div class='code-line code-line-55'>\n</div><div class='code-line code-line-56'>&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: #953800\">p</span>&nbsp;<span style=\"color: #953800\">Util</span><span style=\"color: #24292f;background-color: #f6f8fa\">.</span><span style=\"color: #8250df\">bar</span>&nbsp;<span style=\"color: #6e7781\">#=&gt; 42.0</span>\n</div><div class='code-line code-line-57'>&nbsp;&nbsp;<span style=\"color: #cf222e\">end</span>\n</div><div class='code-line code-line-58'>\n</div><div class='code-line code-line-59'>\n</div><div class='code-line code-line-60'>\n</div><div class='code-line code-line-61'><span style=\"color: #6e7781\">=begin</span>\n</div><div class='code-line code-line-62'>\n</div><div class='code-line code-line-63'><span style=\"color: #6e7781\">  this creates a challenge for the author's of mixins: how to keep code</span>\n</div><div class='code-line code-line-64'><span style=\"color: #6e7781\">  organized *and* provide a module that is safe to mixin to any target.</span>\n</div><div class='code-line code-line-65'>\n</div><div class='code-line code-line-66'>\n</div><div class='code-line code-line-67'><span style=\"color: #6e7781\">  two main approaches exist:</span>\n</div><div class='code-line code-line-68'>\n</div><div class='code-line code-line-69'>\n</div><div class='code-line code-line-70'><span style=\"color: #6e7781\">  1) carve out the mixin seperately from the top-level namespace</span>\n</div><div class='code-line code-line-71'>\n</div><div class='code-line code-line-72'><span style=\"color: #6e7781\">=end</span>\n</div><div class='code-line code-line-73'>\n</div><div class='code-line code-line-74'>&nbsp;&nbsp;<span style=\"color: #24292f;background-color: #f6f8fa\">reset!</span>\n</div><div class='code-line code-line-75'>\n</div><div class='code-line code-line-76'>&nbsp;&nbsp;<span style=\"color: #cf222e\">module</span>&nbsp;<span style=\"color: #953800\">M</span>\n</div><div class='code-line code-line-77'>&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: #cf222e\">module</span>&nbsp;<span style=\"color: #953800\">Mixin</span>\n</div><div class='code-line code-line-78'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: #cf222e\">def</span>&nbsp;<span style=\"color: #8250df\">foo</span>\n</div><div class='code-line code-line-79'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: #0550ae\">42</span>\n</div><div class='code-line code-line-80'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: #cf222e\">end</span>\n</div><div class='code-line code-line-81'>&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: #cf222e\">end</span>\n</div><div class='code-line code-line-82'>\n</div><div class='code-line code-line-83'>&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: #cf222e\">module</span>&nbsp;<span style=\"color: #953800\">Util</span>\n</div><div class='code-line code-line-84'>&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: #cf222e\">end</span>\n</div><div class='code-line code-line-85'>&nbsp;&nbsp;<span style=\"color: #cf222e\">end</span>\n</div><div class='code-line code-line-86'>\n</div><div class='code-line code-line-87'>&nbsp;&nbsp;<span style=\"color: #cf222e\">class</span>&nbsp;<span style=\"color: #953800\">C</span>\n</div><div class='code-line code-line-88'>&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: #cf222e\">include</span>&nbsp;<span style=\"color: #953800\">M</span><span style=\"color: #0550ae\">::</span><span style=\"color: #953800\">Mixin</span>\n</div><div class='code-line code-line-89'>&nbsp;&nbsp;<span style=\"color: #cf222e\">end</span>\n</div><div class='code-line code-line-90'>\n</div><div class='code-line code-line-91'>&nbsp;&nbsp;<span style=\"color: #953800\">p</span>&nbsp;<span style=\"color: #953800\">C</span><span style=\"color: #24292f;background-color: #f6f8fa\">.</span><span style=\"color: #8250df\">new</span><span style=\"color: #24292f;background-color: #f6f8fa\">.</span><span style=\"color: #8250df\">foo</span>&nbsp;<span style=\"color: #6e7781\">#=&gt; 42</span>\n</div><div class='code-line code-line-92'>&nbsp;&nbsp;<span style=\"color: #953800\">p</span>&nbsp;<span style=\"color: #953800\">C</span><span style=\"color: #24292f;background-color: #f6f8fa\">.</span><span style=\"color: #8250df\">const_defined?</span><span style=\"color: #24292f;background-color: #f6f8fa\">(</span><span style=\"color: #0a3069\">:Util</span><span style=\"color: #24292f;background-color: #f6f8fa\">)</span>&nbsp;<span style=\"color: #6e7781\">#=&gt; false</span>\n</div><div class='code-line code-line-93'>\n</div><div class='code-line code-line-94'>\n</div><div class='code-line code-line-95'><span style=\"color: #6e7781\">=begin</span>\n</div><div class='code-line code-line-96'>\n</div><div class='code-line code-line-97'><span style=\"color: #6e7781\">  or</span>\n</div><div class='code-line code-line-98'>\n</div><div class='code-line code-line-99'><span style=\"color: #6e7781\">  2) leverage const_missing to allow simple const aliases into a private namespace</span>\n</div><div class='code-line code-line-100'>\n</div><div class='code-line code-line-101'>\n</div><div class='code-line code-line-102'><span style=\"color: #6e7781\">=end</span>\n</div><div class='code-line code-line-103'>\n</div><div class='code-line code-line-104'>&nbsp;&nbsp;<span style=\"color: #24292f;background-color: #f6f8fa\">reset!</span>\n</div><div class='code-line code-line-105'>\n</div><div class='code-line code-line-106'>&nbsp;&nbsp;<span style=\"color: #cf222e\">module</span>&nbsp;<span style=\"color: #953800\">M</span>\n</div><div class='code-line code-line-107'>&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: #cf222e\">module</span>&nbsp;<span style=\"color: #953800\">Namespace</span>\n</div><div class='code-line code-line-108'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: #cf222e\">module</span>&nbsp;<span style=\"color: #953800\">Util</span>\n</div><div class='code-line code-line-109'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: #cf222e\">def</span>&nbsp;<span style=\"color: #8250df\">foo</span>\n</div><div class='code-line code-line-110'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: #0550ae\">42</span>\n</div><div class='code-line code-line-111'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: #cf222e\">end</span>\n</div><div class='code-line code-line-112'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: #cf222e\">end</span>\n</div><div class='code-line code-line-113'>&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: #cf222e\">end</span>\n</div><div class='code-line code-line-114'>\n</div><div class='code-line code-line-115'>&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: #cf222e\">def</span>&nbsp;<span style=\"color: #953800\">Mixin</span><span style=\"color: #0550ae\">.</span><span style=\"color: #8250df\">const_missing</span><span style=\"color: #24292f;background-color: #f6f8fa\">(</span><span style=\"color: #24292f;background-color: #f6f8fa\">const</span><span style=\"color: #24292f;background-color: #f6f8fa\">)</span>\n</div><div class='code-line code-line-116'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: #cf222e\">begin</span>\n</div><div class='code-line code-line-117'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: #953800\">Namespace</span><span style=\"color: #24292f;background-color: #f6f8fa\">.</span><span style=\"color: #8250df\">const_get</span><span style=\"color: #24292f;background-color: #f6f8fa\">(</span><span style=\"color: #24292f;background-color: #f6f8fa\">const</span><span style=\"color: #24292f;background-color: #f6f8fa\">)</span>\n</div><div class='code-line code-line-118'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: #cf222e\">rescue</span>&nbsp;<span style=\"color: #953800\">Object</span>\n</div><div class='code-line code-line-119'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: #cf222e\">raise</span>\n</div><div class='code-line code-line-120'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: #cf222e\">end</span>\n</div><div class='code-line code-line-121'>&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: #cf222e\">end</span>\n</div><div class='code-line code-line-122'>\n</div><div class='code-line code-line-123'>&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: #cf222e\">def</span>&nbsp;<span style=\"color: #8250df\">foo</span>\n</div><div class='code-line code-line-124'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: #953800\">Util</span><span style=\"color: #24292f;background-color: #f6f8fa\">.</span><span style=\"color: #8250df\">foo</span>\n</div><div class='code-line code-line-125'>&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: #cf222e\">end</span>\n</div><div class='code-line code-line-126'>&nbsp;&nbsp;<span style=\"color: #cf222e\">end</span>\n</div><div class='code-line code-line-127'>\n</div><div class='code-line code-line-128'>&nbsp;&nbsp;<span style=\"color: #cf222e\">class</span>&nbsp;<span style=\"color: #953800\">C</span>\n</div><div class='code-line code-line-129'>&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: #cf222e\">include</span>&nbsp;<span style=\"color: #953800\">M</span><span style=\"color: #0550ae\">::</span><span style=\"color: #953800\">Mixin</span>\n</div><div class='code-line code-line-130'>&nbsp;&nbsp;<span style=\"color: #cf222e\">end</span>\n</div><div class='code-line code-line-131'>\n</div><div class='code-line code-line-132'>&nbsp;&nbsp;<span style=\"color: #953800\">p</span>&nbsp;<span style=\"color: #953800\">C</span><span style=\"color: #24292f;background-color: #f6f8fa\">.</span><span style=\"color: #8250df\">new</span><span style=\"color: #24292f;background-color: #f6f8fa\">.</span><span style=\"color: #8250df\">foo</span>&nbsp;<span style=\"color: #6e7781\">#=&gt; 42</span>\n</div><div class='code-line code-line-133'>&nbsp;&nbsp;<span style=\"color: #953800\">p</span>&nbsp;<span style=\"color: #953800\">C</span><span style=\"color: #24292f;background-color: #f6f8fa\">.</span><span style=\"color: #8250df\">const_defined?</span><span style=\"color: #24292f;background-color: #f6f8fa\">(</span><span style=\"color: #0a3069\">:Util</span><span style=\"color: #24292f;background-color: #f6f8fa\">)</span>&nbsp;<span style=\"color: #6e7781\">#=&gt; false </span>\n</div><div class='code-line code-line-134'>\n</div><div class='code-line code-line-135'>\n</div><div class='code-line code-line-136'>\n</div><div class='code-line code-line-137'><span style=\"color: #6e7781\">=begin</span>\n</div><div class='code-line code-line-138'>\n</div><div class='code-line code-line-139'>\n</div><div class='code-line code-line-140'><span style=\"color: #6e7781\">  so, there you have it: please think carefully about dropping common names</span>\n</div><div class='code-line code-line-141'><span style=\"color: #6e7781\">  inside your mixins as they absolute vommit all their internals into the</span>\n</div><div class='code-line code-line-142'><span style=\"color: #6e7781\">  mixee.</span>\n</div><div class='code-line code-line-143'>\n</div><div class='code-line code-line-144'>\n</div><div class='code-line code-line-145'><span style=\"color: #6e7781\">=end</span>\n</div><div class='code-line code-line-146'>\n</div><div class='code-line code-line-147'>\n</div><div class='code-line code-line-148'>\n</div><div class='code-line code-line-149'>\n</div><div class='code-line code-line-150'>\n</div><div class='code-line code-line-151'>\n</div><div class='code-line code-line-152'>\n</div><div class='code-line code-line-153'>\n</div><div class='code-line code-line-154'>\n</div><div class='code-line code-line-155'><span style=\"color: #cf222e\">BEGIN</span>&nbsp;<span style=\"color: #24292f;background-color: #f6f8fa\">{</span>\n</div><div class='code-line code-line-156'>&nbsp;&nbsp;<span style=\"color: #cf222e\">def</span>&nbsp;<span style=\"color: #8250df\">reset!</span>\n</div><div class='code-line code-line-157'>&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: #953800\">self</span><span style=\"color: #24292f;background-color: #f6f8fa\">.</span><span style=\"color: #8250df\">class</span><span style=\"color: #24292f;background-color: #f6f8fa\">.</span><span style=\"color: #8250df\">send</span>&nbsp;<span style=\"color: #0a3069\">:remove_const</span><span style=\"color: #24292f;background-color: #f6f8fa\">,</span>&nbsp;<span style=\"color: #0a3069\">:Mixin</span>&nbsp;<span style=\"color: #cf222e\">rescue</span>&nbsp;<span style=\"color: #cf222e\">false</span>\n</div><div class='code-line code-line-158'>&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: #953800\">self</span><span style=\"color: #24292f;background-color: #f6f8fa\">.</span><span style=\"color: #8250df\">class</span><span style=\"color: #24292f;background-color: #f6f8fa\">.</span><span style=\"color: #8250df\">send</span>&nbsp;<span style=\"color: #0a3069\">:remove_const</span><span style=\"color: #24292f;background-color: #f6f8fa\">,</span>&nbsp;<span style=\"color: #0a3069\">:C</span>&nbsp;<span style=\"color: #cf222e\">rescue</span>&nbsp;<span style=\"color: #cf222e\">false</span>\n</div><div class='code-line code-line-159'>&nbsp;&nbsp;<span style=\"color: #cf222e\">end</span>\n</div><div class='code-line code-line-160'><span style=\"color: #24292f;background-color: #f6f8fa\">}</span>\n</div><div class='code-line code-line-161'>\n</div><div class='code-line code-line-162'>\n</div></code></div>\n\n</div>\n",
      "assets": {},
      "_meta": {
        "identifier": "dojo4/writing-hygienic-mixins-in-ruby",
        "type": "dojo4",
        "id": "writing-hygienic-mixins-in-ruby",
        "urls": [
          "/ro/dojo4/writing-hygienic-mixins-in-ruby/body.md"
        ],
        "created_at": "2025-05-06 08:47:14 +0000",
        "updated_at": "2025-05-06 08:47:14 +0000",
        "rel": {
          "curr": "dojo4/writing-hygienic-mixins-in-ruby",
          "prev": "dojo4/mobile-detection-behind-a-cdn",
          "next": "dojo4/what-dojo4-did-over-the-weekend"
        }
      }
    }
  },
  "_meta": {
    "url": "/ro",
    "type": "dojo4",
    "id": "writing-hygienic-mixins-in-ruby"
  }
}