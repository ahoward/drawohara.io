<html color-mode="user" lang="uk">
  <head>
  <base href='/uk' />
  <!-- ga -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-DQVD9T27V4"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-DQVD9T27V4');
</script>

  <!-- deps -->
    <script type="module" src="/assets/js/turbo.es2017-esm.js" defer></script>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.fluid.classless.fuchsia.min.css"
    >

  <!-- defaults -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="color-scheme" content="light dark" />

  <!-- favicon -->
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">

  <!-- meta -->
    <title>Від скороченого стеку стартапу до відповідності PCI на AWS</title>

<meta property="og:title" content="Від скороченого стеку стартапу до відповідності PCI на AWS"/>
<meta property="og:description" content="рухайтеся далі." />
<meta property="og:image" content="https://drawohara.io/media/mick.jpg" />

<meta property="og:image:type" content="image/jpeg" />

    <meta property="site:route" content=""/dojo4/archive/:id"">
    <meta property="site:params" content="{"ext":null,"id":"from-a-streamlined-startup-stack-to-pci-compliance-on-aws"}">
    <meta property="site:path_info" content=""/from-a-streamlined-startup-stack-to-pci-compliance-on-aws"">

    <style>
      /* anti pico */
      a {text-decoration: none !important; }

      /* anti turbo */
      html { transition: none !important; }
      .turbo-progress-bar { visibility: hidden; }

      /* anti progressive */
      html { margin: 1em; }
      img { display: block; text-align: center; }
    </style>

    <script>
      document.addEventListener("turbo:load", function() {
        const progressBar = document.querySelector('.turbo-progress-bar');
        if (progressBar) {
          progressBar.remove();
        }
      });
    </script>
  </head>

  <body>
    <header>
      <a href="/home">@drawohara</a>
<hr>
    </header>

    <main>
      <div class="ro markdown">
  <h2 id="intro">Вступ</h2>

<p>Працюючи над проектами в <a href="http://dojo4.com">Dojo4</a>, я часто дивуюсь, як, здається, невеликі збільшення технічної складності <a href="http://uk.wikipedia.org/wiki/Combinatorial_explosion">збільшуються</a> до значних відволікань уваги та ресурсів. В результаті, коли проекти тільки починаються, ми схиляємося до використання спрощеного стеку хостингу та застосунків, який має багато спільних рис з поширеними хостинговими послугами. Це включає такі рішення, як хостинг додатку та бази даних разом, використання одного користувача розгортання на хостинговому сервері та простий <a href="http://uptimerobot.com">моніторинг часу безумовної роботи</a>.</p>

<p>Нещодавно наш давній клієнт, <a href="http://www.inspirecommerce.com/">Inspire Commerce</a>, розробив новий бізнес-план, який вимагає, щоб їх додаток відповідав суворим вимогам безпеки рівня 1 <a href="https://www.pcisecuritystandards.org/">Індустрії платіжних карток</a> (PCI) для обробки, передачі та зберігання інформації про кредитні картки. Багато вимог безпеки, викладених у стандарті безпеки даних PCI <a href="https://www.pcisecuritystandards.org/security_standards/">(DSS)</a>, спонукають до значної зміни мислення від згаданого вище спрощеного стеку. Ця стаття коротко перерахує деякі з цих деталей та опише наші рішення.</p>

<p>PCI DSS поділяється на 12 розділів, які охоплюють все: від конфігурації брандмауерів до політик безпеки персоналу. Я перерахую декілька розділів, які стосуються хостингового стеку.</p>

<h2 id="1-install-and-maintain-a-firewall-configuration-to-protect-cardholder-data">1. Встановіть та підтримуйте конфігурацію брандмауерів для захисту даних власників карток</h2>

<p>Це досить детальний розділ DSS, який вимагає встановлення та налаштування <a href="http://uk.wikipedia.org/wiki/Firewall_%28computing%29">брандмауерів</a> на всіх мережевих пристроях, від робочих станцій до маршрутизаторів та серверів. Використовуючи <a href="http://aws.amazon.com/">Amazon Web Services</a> (AWS) <a href="http://aws.amazon.com/ec2/">Elastic Compute Cloud</a> (EC2) як основу нашого хостингового стеку, багато з цих мережевих пристроїв абстрагуються з нашого поля зору або контролю. Зручно, що <a href="http://aws.amazon.com/security/#certifications">AWS сам по собі відповідає PCI рівня 1</a>, залишаючи багато з цих деталей інженерам Amazon.</p>

<p>Однак брандмауери для вузлів EC2 все ж вимагають деякої уваги. Вузли EC2 захищаються брандмауером, реалізованим на рівні <a href="www.xen.org/products/xenhyp.html">гіпервізора</a> та налаштованим групами безпеки AWS. Наша базова група безпеки забороняє всі порти, крім 22, 80 та 443, які приймають пакети з усіх джерел. Ми використовуємо <a href="www.ubuntu.com/">Ubuntu Linux</a> на наших вузлах, і з коробки в нас налаштований <a href="www.netfilter.org/projects/iptables/">IP Tables</a> брандмауер з відкритою політикою.</p>

<p>PCI DSS зосереджується на використанні брандмауерів для створення безпечних приватних мереж або <a href="http://uk.wikipedia.org/wiki/DMZ_%28computing%29">демілітаризованих зон</a> (DMZ) для систем, які хостять додатки, що обробляють дані платіжних карток. Групи безпеки AWS забезпечують корисний механізм для створення безпечних приватних мереж між різними компонентами стеку додатків. Наприклад, створюючи групу безпеки WEB та групу безпеки DB, і відкриваючи порт бази даних у групі безпеки DB лише для джерел групи безпеки WEB, гіпервізорний брандмауер EC2, що працює на сервері бази даних, дозволить доступ до бази даних лише з веб-серверів, що підключаються до внутрішнього приватного мережевого інтерфейсу.</p>

<p>Для забезпечення відмовчості ми віддзеркалюємо конфігурацію групи безпеки AWS для гіпервізорного брандмауера EC2 з допомогою сервісу <a href="http://www.cloudpassage.com/">CloudPassage</a>, який може керувати брандмауером IP Tables на рівні операційної системи систем, які хостять компоненти додатку для обробки карток. CloudPassage організовує політики брандмауерів у <a href="http://www.cloudpassage.com/features/halo-firewall.html">групах серверів</a>, які трохи аналогічні групам безпеки AWS. Ще одна чудова функція CloudPassage - це сервіс <a href="http://www.cloudpassage.com/features/multifactor-authentication.html">GhostPorts</a>. Ми налаштовуємо політику порту ssh у CloudPassage для приймання з'єднань з джерел GhostPort. Щоб клієнтський комп'ютер став джерелом GhostPort, користувач на цьому комп'ютері повинен пройти аутентифікацію в порталі CloudPassage, бути авторизованим для відкриття GhostPorts для групи серверів та пройти аутентифікацію з зареєстрованим ключем Yubikey або відповісти на SMS-виклик зареєстрованим мобільним телефоном. Після успішної аутентифікації та авторизації CloudPassage налаштовує IP Tables для приймання з'єднань з ip-адреси джерела клієнтського комп'ютера. Це зручний, безпечний, тимчасовий та прозорий спосіб керування доступом до чутливих хостів.</p>

<h2 id="2-do-not-use-vendor-supplied-defaults-for-system-passwords-and-other-security-parameters">2. Не використовуйте стандартні налаштування постачальників для системних паролів та інших параметрів безпеки</h2>

<p>Цей розділ, здається, досить очевидний. Хорошим прикладом важливості зміни стандартних паролів постачальника є стандартний пароль changeme <a href="http://www.splunk.com/">Splunk</a> <a href="http://docs.splunk.com/Documentation/Splunk/latest/Deploy/Introducingtheuniversalforwarder">Універсального пересилача</a>.</p>

<p>Однак у цьому розділі є важливе вимоге до хостингу, яке дещо не пов'язане з назвою розділу. "2.2.1 Реалізуйте лише одну основну функцію на сервері, щоб запобігти співіснуванню функцій, які вимагають різних рівнів безпеки на одному сервері. (Наприклад, веб-сервери, сервери баз даних та DNS повинні бути реалізовані на окремих серверах)"</p>

<p>Як згадувалося вище, групи безпеки AWS роблять завдання безпечного розділення сервісів, таких як веб-сервери та сервери баз даних, на окремі хости зовсім простим.</p>

<h2 id="5-use-and-regularly-update-anti-virus-software-or-programs">5. Використовуйте та регулярно оновлюйте антивірусне програмне забезпечення</h2>

<p><a href="http://clamav.com">ClamAV</a> швидко справляється з цією вимогою на Ubuntu Linux.</p>

<h2 id="8-assign-a-unique-id-to-each-person-with-computer-access">8. Призначте унікальний ідентифікатор кожній особі з комп'ютерним доступом</h2>

<p>Мета цього розділу - забезпечити можливість аудиту та підзвітності шляхом видалення спільних користувацьких облікових записів. Оскільки ми використовуємо <a href="http://uk.wikipedia.org/wiki/Ssh-keygen">механізм аутентифікації на основі ключів</a> для <a href="http://uk.wikipedia.org/wiki/Secure_Shell">безпечного доступу через оболонку</a>, є три основні питання щодо того, хто що робив. Спочатку необхідно запобігти користувачам переключатися на інший користувацький обліковий запис за допомогою команди <a href="http://uk.wikipedia.org/wiki/Su_%28Unix%29">su</a>. Це легко зробити, видаливши <a href="http://uk.wikipedia.org/wiki/Filesystem_permissions#Traditional_Unix_permissions">права на виконання</a> на su бінарному файлі та змінивши <a href="http://aplawrence.com/Basics/understandingpam.html">/etc/pam.d</a> щоб запобігти будь-якій авторизації su. По-друге, переконайтеся, що файли <a href="http://www.eng.cam.ac.uk/help/jpmg/ssh/authorized_keys_howto.html">authorized_keys</a> для всіх користувацьких облікових записів містять лише один запис. Нарешті, переконайтеся, що всі ключі, які використовуються для безпечного доступу через оболонку, захищені паролем, і що існує політика, яка забороняє користувачам ділитися ключами.</p>

<p>Тепер <a href="http://www.cyberciti.biz/tips/linux-audit-files-to-see-who-made-changes-to-a-file.html">Linux Audit Daemon</a> (AuditD) можна використовувати для відстеження системної діяльності конкретними користувачами.</p>

<h2 id="9-restrict-physical-access-to-cardholder-data">9. Обмежте фізичний доступ до даних власників карток</h2>

<p>Назва цього розділу досить однозначна. Основним питанням цього розділу є обмеження фізичного доступу до центру обробки даних для авторизованих осіб. Подібно до обговорення конфігурації брандмауерів мережевих пристроїв вище, це охоплюється сертифікацією AWS PCI рівня 1, і деталі можна залишити Amazon.</p>

<h2 id="10-track-and-monitor-all-access-to-network-resources-and-cardholder-data">10. Відстежуйте та контролюйте весь доступ до мережевих ресурсів та даних власників карток</h2>

<p>Мотивація цього розділу - "запобігання, виявлення або мінімізація впливу компрометації даних". Це включає такі теми, як ведення журналів, управління цілісністю файлів та виявлення вторгнень. Наша стратегія починається з використання сервісу ведення журналів для підтримки агрегації журналів, збереження журналів, а також пошуку записів журналів. Ми використовуємо додаток <a href="http://splunk.com">Splunk</a> для цієї функціональності. Ми налаштували екземпляр EC2 для сервера ведення журналів та встановили Splunk. Ми налаштували групи безпеки AWS та CloudPassage ServerGroups для нового сервера, у якого порт слухача Splunk приймає з'єднання з джерел веб-сервера та сервера бази даних на приватному мережевому інтерфейсі. Потім ми налаштували Універсальний пересилач Splunk на веб-серверах та серверах баз даних та налаштували пересилачі для моніторингу журналів додатків, apache, mongodb, sys, audit та auth.</p>

<p>Для моніторингу цілісності файлів та виявлення вторгнень ми встановили додаток <a href="http://www.ossec.net/?page_id=165">OSSEC</a> на всіх наших серверах та додали всі журнали, які пише OSSEC, до пересилачів Splunk.</p>

</div>
    </main>

    <footer>
      <hr>
<a href="/goto" name="goto">&mdash;&gt; goto</a>
<blockquote>
<ul>
  <li>
    <a href="/about">про нас<a>
  </li>
  <li>
    <a href="mailto:i-hate-this@drawohara.io?subject=/from-a-streamlined-startup-stack-to-pci-compliance-on-aws">i-hate-this<a>
  </li>
  <li>
    <a href="mailto:i-love-this@drawohara.io?subject=/from-a-streamlined-startup-stack-to-pci-compliance-on-aws">i-love-this<a>
  </li>
  <li>
    <a href="/contact">контакти<a>
  </li>
</ul>
</blockquote>
<a href="/">&lt;&mdash; eject</a>
    </footer>
  </body>
</html>